<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="18087" />

<meta name="date" content="2019-01-09" />

<title>Exercise of Statistical Computing course</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Exercise of Statistical Computing course</h1>
<h4 class="author"><em>18087</em></h4>
<h4 class="date"><em>20190109</em></h4>



<div id="exercise-1-20180914" class="section level2">
<h2>Exercise 1 (20180914)</h2>
</div>
<div id="problem-1" class="section level2">
<h2>Problem 1</h2>
(Spectral decomposition method) How to generate a bivariate normal sample with zero mean vector and
<span class="math display">\[\begin{equation}
\Sigma=\left[\begin{array}{cc}
1.0 &amp; 0.9\\
0.9 &amp; 1.0
\end{array}
\right]
\end{equation}\]</span>
<p>.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>This example provides a function <span class="math inline">\(\textbf{rmvn.eigen}\)</span> to generate a multivariate normal random sample.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># mean and covariance parameters</span>
mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)
Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">9</span>, <span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</code></pre></div>
<p>The eigen function returns the eigenvalues and eigenvectors of a matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rmvn.eigen &lt;-
<span class="cf">function</span>(n, mu, Sigma) {
<span class="co"># generate n random vectors from MVN(mu, Sigma)</span>
<span class="co"># dimension is inferred from mu and Sigma</span>
d &lt;-<span class="st"> </span><span class="kw">length</span>(mu)
ev &lt;-<span class="st"> </span><span class="kw">eigen</span>(Sigma, <span class="dt">symmetric =</span> <span class="ot">TRUE</span>)
lambda &lt;-<span class="st"> </span>ev<span class="op">$</span>values
V &lt;-<span class="st"> </span>ev<span class="op">$</span>vectors
R &lt;-<span class="st"> </span>V <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(lambda)) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(V)
Z &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n<span class="op">*</span>d), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> d)
X &lt;-<span class="st"> </span>Z <span class="op">%*%</span><span class="st"> </span>R <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(mu, n, d, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
X
}</code></pre></div>
<p>Print summary statistics and display a scatterplot as a check on the results of the simulation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X &lt;-<span class="st"> </span><span class="kw">rmvn.eigen</span>(<span class="dv">1000</span>, mu, Sigma)  <span class="co"># generate the sample</span>
<span class="kw">plot</span>(X, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">colMeans</span>(X))</code></pre></div>
<pre><code>## [1] 0.07847162 0.05717890</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">cor</span>(X))</code></pre></div>
<pre><code>##          [,1]     [,2]
## [1,] 1.000000 0.894599
## [2,] 0.894599 1.000000</code></pre>
</div>
<div id="problem-2" class="section level2">
<h2>Problem 2</h2>
<p>(A simple approach simulation of a Poisson process with rate ??) Suppose we need N(3), the number of arrivals in [0,3]. Generate iid exponential times <span class="math inline">\(T_i\)</span> with rate <span class="math inline">\(\lambda\)</span> and find the index n where the cumulative sum <span class="math inline">\(S_n = T_1 + \cdots+ T_n\)</span> first exceeds 3.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>It follows that the number of arrivals in [0,3] is <span class="math inline">\(n-1\)</span>. On average this number is E[N(3)] = 3??.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lambda &lt;-<span class="st"> </span><span class="dv">2</span>
t0 &lt;-<span class="st"> </span><span class="dv">3</span>
Tn &lt;-<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">100</span>, lambda) <span class="co">#interarrival times</span>
Sn &lt;-<span class="st"> </span><span class="kw">cumsum</span>(Tn) <span class="co">#arrival times</span>
n &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(Sn <span class="op">&gt;</span><span class="st"> </span>t0)) <span class="co">#arrivals+1 in [0, t0]</span></code></pre></div>
<p>Results from two runs are shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n<span class="op">-</span><span class="dv">1</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(Sn[<span class="dv">1</span><span class="op">:</span>n], <span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] 0.0269 0.1507 0.4772 0.4823 1.1480 3.8601</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n<span class="op">-</span><span class="dv">1</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(Sn[<span class="dv">1</span><span class="op">:</span>n], <span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] 0.0269 0.1507 0.4772 0.4823 1.1480 3.8601</code></pre>
<p>For this example, the average of simulated values <span class="math inline">\(N(3)=n-1\)</span> for a large number of runs should be close to <span class="math inline">\(E\left[N(3)\right] = 3\lambda = 6\)</span>.</p>
<p>An alternate method of generating the arrival times of a Poisson process is based on the fact that given the number of arrivals in an interval <span class="math inline">\((0,t)\)</span>. Applying the conditional distribution of the arrival times, it is possible to simulate a Poisson(<span class="math inline">\(\lambda\)</span>) process on an interval <span class="math inline">\((0,t)\)</span> by first generating a random observation n from the Poisson(<span class="math inline">\(\lambda t\)</span>) distribution, then generating a random sample of n Uniform<span class="math inline">\((0,t)\)</span> observations and ordering the uniform sample to obtain the arrival times.</p>
<p>Returning to Question 2, simulate a Poisson(<span class="math inline">\(\lambda\)</span>) process and find N(3), using the conditional distribution of the arrival times. As a check, we estimate the mean and variance of N(3) from 10000 replications.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lambda &lt;-<span class="st"> </span><span class="dv">2</span>
t0 &lt;-<span class="st"> </span><span class="dv">3</span>
upper &lt;-<span class="st"> </span><span class="dv">100</span>
pp &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10000</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>) {
N &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">1</span>, lambda <span class="op">*</span><span class="st"> </span>upper)
Un &lt;-<span class="st"> </span><span class="kw">runif</span>(N, <span class="dv">0</span>, upper) <span class="co">#unordered arrival times</span>
Sn &lt;-<span class="st"> </span><span class="kw">sort</span>(Un) <span class="co">#arrival times</span>
n &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(Sn <span class="op">&gt;</span><span class="st"> </span>t0)) <span class="co">#arrivals+1 in [0, t0]</span>
pp[i] &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span><span class="dv">1</span> <span class="co">#arrivals in [0, t0]</span>
}</code></pre></div>
<p>Alternately, the loop can be replaced by replicate, as shown.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pp &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">10000</span>, <span class="dt">expr =</span> {
N &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">1</span>, lambda <span class="op">*</span><span class="st"> </span>upper)
Un &lt;-<span class="st"> </span><span class="kw">runif</span>(N, <span class="dv">0</span>, upper) <span class="co">#unordered arrival times</span>
Sn &lt;-<span class="st"> </span><span class="kw">sort</span>(Un) <span class="co">#arrival times</span>
n &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">which</span>(Sn <span class="op">&gt;</span><span class="st"> </span>t0)) <span class="co">#arrivals+1 in [0, t0]</span>
n <span class="op">-</span><span class="st"> </span><span class="dv">1</span> }) <span class="co">#arrivals in [0, t0]</span></code></pre></div>
<p>The mean and variance should both be equal to ??t = 6 in this example. Here the sample mean and sample variance of the generated values N(3) are indeed very close to 6.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">c</span>(<span class="kw">mean</span>(pp), <span class="kw">var</span>(pp))</code></pre></div>
<pre><code>## [1] 5.99810 5.93329</code></pre>
</div>
<div id="problem-3" class="section level2">
<h2>Problem 3</h2>
<p>Scatterplot matrix.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<p>We compare the four variables in the iris data for the species virginica, in a scatterplot matrix.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(iris)
<span class="co">#virginica data in first 4 columns of the last 50 obs.</span>
<span class="kw">pairs</span>(iris[<span class="dv">101</span><span class="op">:</span><span class="dv">150</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In the plot produced by the <span class="math inline">\(\textbf{pairs}\)</span> command above the variable names will appear along the diagonal. The <span class="math inline">\(\textbf{pairs}\)</span> function takes an optional argument <span class="math inline">\(\textbf{diag.panel}\)</span>, which is a function that determines what is displayed along the diagonal. For example, to obtain a graph with estimated density curves along the diagonal, supply the name of a function to plot the densities.The function below called <span class="math inline">\(\textbf{panel.d}\)</span> plots the densities.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">panel.d &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...) {
usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>)
<span class="kw">on.exit</span>(<span class="kw">par</span>(usr))
<span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(usr[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">0</span>, .<span class="dv">5</span>))
<span class="kw">lines</span>(<span class="kw">density</span>(x))
}</code></pre></div>
<p>In <span class="math inline">\(\textbf{panel.d}\)</span>, the graphics parameter <span class="math inline">\(\textbf{usr}\)</span> specifies the extremes of the user coordinates of the plotting region. Before plotting, we apply the <span class="math inline">\(\textbf{scale}\)</span> function to standardize each of the one-dimensional samples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">scale</span>(iris[<span class="dv">101</span><span class="op">:</span><span class="dv">150</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])
r &lt;-<span class="st"> </span><span class="kw">range</span>(x)
<span class="kw">pairs</span>(x, <span class="dt">diag.panel =</span> panel.d, <span class="dt">xlim =</span> r, <span class="dt">ylim =</span> r)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plot we can observe that the length variables are positively correlated, and the width variables appear to be positively correlated. Other structure could be present in the data that is not revealed by the bivariate marginal distributions.</p>
<p>The <span class="math inline">\(\textbf{lattice}\)</span> package provides functions to construct panel displays.Here we illustrate the scatterplot matrix function <span class="math inline">\(\textbf{splom}\)</span> in <span class="math inline">\(\textbf{lattice}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)
<span class="kw">splom</span>(iris[<span class="dv">101</span><span class="op">:</span><span class="dv">150</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]) <span class="co">#plot 1</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#for all 3 at once, in color, plot 2</span>
<span class="kw">splom</span>(iris[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">groups =</span> iris<span class="op">$</span>Species)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#for all 3 at once, black and white, plot 3</span>
<span class="kw">splom</span>(<span class="op">~</span>iris[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">groups =</span> Species, <span class="dt">data =</span> iris,<span class="dt">col =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">cex =</span> <span class="kw">c</span>(.<span class="dv">5</span>,.<span class="dv">5</span>,.<span class="dv">5</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>On screen the panel display is easier to interpret when displayed in color (plot 2).</p>
<p>Also see the 3D scatterplot of the iris data.This example uses the <span class="math inline">\(\textbf{cloud}\)</span> function in the <span class="math inline">\(\textbf{lattice}\)</span> package to display a <span class="math inline">\(\textbf{3D}\)</span> scatterplot of the <span class="math inline">\(\textbf{iris}\)</span> data. There are three species of iris and each is measured on four variables. The following code produces a <span class="math inline">\(\textbf{3D}\)</span> scatterplot of sepal length, sepal width, and petal length.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)
<span class="kw">attach</span>(iris)
<span class="co">#basic 3 color plot with arrows along axes</span>
<span class="kw">print</span>(<span class="kw">cloud</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">*</span><span class="st"> </span>Sepal.Width,
<span class="dt">data=</span>iris, <span class="dt">groups=</span>Species))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The <span class="math inline">\(\textbf{iris}\)</span> data has four variables, so there are four subsets of three variables to graph. To see all four plots on the screen, use the <span class="math inline">\(\textbf{more}\)</span> and <span class="math inline">\(\textbf{split}\)</span> options.The <span class="math inline">\(\textbf{split}\)</span> arguments determine the location of the plot within the panel display.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">cloud</span>(Sepal.Length <span class="op">~</span><span class="st"> </span>Petal.Length <span class="op">*</span><span class="st"> </span>Petal.Width,
<span class="dt">data =</span> iris, <span class="dt">groups =</span> Species, <span class="dt">main =</span> <span class="st">&quot;1&quot;</span>, <span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,
<span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">draw =</span> <span class="ot">FALSE</span>), <span class="dt">zlab =</span> <span class="st">&quot;SL&quot;</span>,
<span class="dt">screen =</span> <span class="kw">list</span>(<span class="dt">z =</span> <span class="dv">30</span>, <span class="dt">x =</span> <span class="op">-</span><span class="dv">75</span>, <span class="dt">y =</span> <span class="dv">0</span>)),
<span class="dt">split =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">more =</span> <span class="ot">TRUE</span>)

<span class="kw">print</span>(<span class="kw">cloud</span>(Sepal.Width <span class="op">~</span><span class="st"> </span>Petal.Length <span class="op">*</span><span class="st"> </span>Petal.Width,
<span class="dt">data =</span> iris, <span class="dt">groups =</span> Species, <span class="dt">main =</span> <span class="st">&quot;2&quot;</span>, <span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,
<span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">draw =</span> <span class="ot">FALSE</span>), <span class="dt">zlab =</span> <span class="st">&quot;SW&quot;</span>,
<span class="dt">screen =</span> <span class="kw">list</span>(<span class="dt">z =</span> <span class="dv">30</span>, <span class="dt">x =</span> <span class="op">-</span><span class="dv">75</span>, <span class="dt">y =</span> <span class="dv">0</span>)),
<span class="dt">split =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">more =</span> <span class="ot">TRUE</span>)

<span class="kw">print</span>(<span class="kw">cloud</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">*</span><span class="st"> </span>Sepal.Width,
<span class="dt">data =</span> iris, <span class="dt">groups =</span> Species, <span class="dt">main =</span> <span class="st">&quot;3&quot;</span>, <span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,
<span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">draw =</span> <span class="ot">FALSE</span>), <span class="dt">zlab =</span> <span class="st">&quot;PL&quot;</span>,
<span class="dt">screen =</span> <span class="kw">list</span>(<span class="dt">z =</span> <span class="dv">30</span>, <span class="dt">x =</span> <span class="op">-</span><span class="dv">55</span>, <span class="dt">y =</span> <span class="dv">0</span>)),
<span class="dt">split =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">more =</span> <span class="ot">TRUE</span>)

<span class="kw">print</span>(<span class="kw">cloud</span>(Petal.Width <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">*</span><span class="st"> </span>Sepal.Width,
<span class="dt">data =</span> iris, <span class="dt">groups =</span> Species, <span class="dt">main =</span> <span class="st">&quot;4&quot;</span>, <span class="dt">pch=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,
<span class="dt">scales =</span> <span class="kw">list</span>(<span class="dt">draw =</span> <span class="ot">FALSE</span>), <span class="dt">zlab =</span> <span class="st">&quot;PW&quot;</span>,
<span class="dt">screen =</span> <span class="kw">list</span>(<span class="dt">z =</span> <span class="dv">30</span>, <span class="dt">x =</span> <span class="op">-</span><span class="dv">55</span>, <span class="dt">y =</span> <span class="dv">0</span>)),
<span class="dt">split =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">detach</span>(iris)</code></pre></div>
<p>The plots show that the three species of iris are separated into groups or clusters in the three dimensional subspaces spanned by any three of the four variables. There is some structure evident in these plots. One might follow up with cluster analysis or principal components analysis to analyze the apparent structure in the data.</p>
</div>
<div id="problem-4" class="section level2">
<h2>Problem 4</h2>
<p>(Simple Monte Carlo integration) Compute a Monte Carlo estimate of <span class="math display">\[\theta=\int_0^1{e^{-x}}dx\]</span> and compare the estimate with the exact value.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
The simple Monte Carlo estimator of the integral <span class="math inline">\(\theta=\int_a^bg(x)\)</span> is computed as follows.

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">10000</span>
x &lt;-<span class="st"> </span><span class="kw">runif</span>(m)
theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(<span class="op">-</span>x))
<span class="kw">print</span>(theta.hat)</code></pre></div>
<pre><code>## [1] 0.6302957</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))</code></pre></div>
<pre><code>## [1] 0.6321206</code></pre>
<p>The estimate is <span class="math inline">\(\hat{\theta}=0.6355\)</span> and <span class="math inline">\(\theta=1-{e^{-1}}=0.6321\)</span>.</p>
</div>
<div id="exercise-2-20180921" class="section level2">
<h2>Exercise 2 (20180921)</h2>
</div>
<div id="problem-3.5" class="section level2">
<h2>Problem 3.5</h2>
A discrete random variable <span class="math inline">\(\mathbf{X}\)</span> has probability mass function
<span class="math display">\[\begin{array}{c|cccc} 
x &amp; \text{0} &amp; \text{1} &amp; \text{2} &amp; \text{3} &amp; \text{4}\\ 
\hline 
\text{p(x)} &amp; 0.1 &amp; 0.2 &amp; 0.2 &amp; 0.2 &amp; 0.3\\ 
\end{array}\]</span>
<p>Use the inverse transform method to generate a random sample of size 1000 from the distribution of X. Construct a relative frequency table and compare the empirical with the theoretical probabilities. Repeat using the <span class="math inline">\(\textbf{R sample}\)</span> function.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>The inverse transform sampling method works as follows:</p>
<p>(a)Generate a random u from Uniform(0,1).</p>
<p>(b)Deliver <span class="math inline">\(x_i\)</span> where <span class="math inline">\(F(x_{i-1})\lt u\le F(x_i)\)</span>.</p>
<p>The complete code is as follows:</p>
<p>(1)Generate a random sample of size 1000 from the distribution of X using the inverse transform sampling method:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
n &lt;-<span class="st"> </span><span class="dv">1000</span>
p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>)<span class="co">#The theoretical probabilitie vector</span>
cp &lt;-<span class="st"> </span><span class="kw">cumsum</span>(p) <span class="co">#The cumulative probability vector</span>
x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">4</span>

x1 &lt;-<span class="st"> </span>x[<span class="kw">findInterval</span>(<span class="kw">runif</span>(n), cp) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>]

##Construct a relative frequency table
y &lt;-<span class="st"> </span><span class="kw">table</span>(x1)
y1 &lt;-<span class="st"> </span><span class="kw">as.vector</span>(y)
z &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(x1))
z1 &lt;-<span class="st"> </span><span class="kw">as.vector</span>(z)
comparation &lt;-<span class="st"> </span><span class="kw">data.frame</span>(y1,z1,p)
<span class="kw">dimnames</span>(comparation)=<span class="kw">list</span>(<span class="kw">c</span>(<span class="st">'0'</span>,<span class="st">'1'</span>,<span class="st">'2'</span>,<span class="st">'3'</span>,<span class="st">'4'</span>),<span class="kw">c</span>(<span class="st">&quot;frequency&quot;</span>,<span class="st">&quot;empirical probabilities&quot;</span>,<span class="st">&quot;theoretical probabilities&quot;</span>))
comparation <span class="co"># Output frequency table</span></code></pre></div>
<pre><code>##   frequency empirical probabilities theoretical probabilities
## 0        92                   0.092                       0.1
## 1       199                   0.199                       0.2
## 2       191                   0.191                       0.2
## 3       216                   0.216                       0.2
## 4       302                   0.302                       0.3</code></pre>
<p>As can be seen from the frequency table, the empirical frequency is not much different from the theoretical frequency.</p>
<p>(3)Also we can generate the required random sample without using the <span class="math inline">\(\textbf{R sample}\)</span> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y_sample=<span class="kw">sample</span>(<span class="dt">x=</span><span class="dv">0</span><span class="op">:</span><span class="dv">4</span>,<span class="dt">size=</span>n,<span class="dt">replace=</span>T,<span class="dt">prob=</span>p)

##Construct a relative frequency table
z &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="kw">table</span>(y_sample))
z1 &lt;-<span class="st"> </span><span class="kw">as.vector</span>(z)
comp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z1,p)
<span class="kw">dimnames</span>(comp)=<span class="kw">list</span>(<span class="kw">c</span>(<span class="st">'0'</span>,<span class="st">'1'</span>,<span class="st">'2'</span>,<span class="st">'3'</span>,<span class="st">'4'</span>),<span class="kw">c</span>(<span class="st">&quot;empirical probabilities&quot;</span>,<span class="st">&quot;theoretical probabilities&quot;</span>))
comp<span class="co"># Output frequency table</span></code></pre></div>
<pre><code>##   empirical probabilities theoretical probabilities
## 0                   0.085                       0.1
## 1                   0.186                       0.2
## 2                   0.201                       0.2
## 3                   0.214                       0.2
## 4                   0.314                       0.3</code></pre>
<p>As can be seen from the frequency table, the empirical frequency is not much different from the theoretical frequency.</p>
</div>
<div id="problem-3.7" class="section level2">
<h2>Problem 3.7</h2>
<p>Write a function to generate a random sample of size n from the Beta(a, b) distribution by the acceptance-rejection method. Generate a random sample of size 1000 from the Beta(3,2) distribution. Graph the histogram of the sample with the theoretical Beta(3,2) density superimposed.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li>The function to generate a random sample of size n from the Beta(a,b) distribution by the acceptance-rejection method is as follows:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample.beta &lt;-<span class="st"> </span><span class="cf">function</span>(n,a,b,...){
  k &lt;-<span class="st"> </span><span class="dv">0</span> <span class="co">#counter for accepted</span>
  y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
  
  <span class="cf">while</span> (k <span class="op">&lt;</span><span class="st"> </span>n) {
    u &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)
    x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g</span>
    <span class="cf">if</span> (x<span class="op">^</span>(a<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span>(b<span class="op">-</span><span class="dv">1</span>) <span class="op">&gt;</span><span class="st"> </span>u) {
      <span class="co">#we accept x</span>
      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
      y[k] &lt;-<span class="st"> </span>x
    }
  }
  y
}</code></pre></div>
<p>(2)The Beta(3,2) density is <span class="math inline">\(f(x)=12{x^2}(1-x)\)</span>, <span class="math inline">\(0&lt;x&lt;1\)</span>.Let g(x) be the Uniform(0,1) density.Then <span class="math inline">\(f(x)/g(x)\le 1\)</span> for all <span class="math inline">\(0&lt;x&lt;1\)</span>, so <span class="math inline">\(c=1\)</span>. A random x from g(x) is accepted if <span class="math display">\[\frac{f(x)}{cg(x)}=\frac{12{x^2}(1-x)}{1(1)}=12{x^2}(1-x)\gt u\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Generate a sample of size 1000 from the Beta(3,2) distribution
n &lt;-<span class="st"> </span><span class="dv">1000</span>
y &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
y &lt;-<span class="st"> </span><span class="kw">sample.beta</span>(n,<span class="dv">3</span>,<span class="dv">2</span>)<span class="co">#Using the sample.beta function</span></code></pre></div>
<p>Compare the empirical and theoretical percentiles:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##compare empirical and theoretical percentiles
p &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>)
Qhat &lt;-<span class="st"> </span><span class="kw">quantile</span>(y, p) <span class="co">#quantiles of sample</span>
Q &lt;-<span class="st"> </span><span class="kw">qbeta</span>(p, <span class="dv">3</span>, <span class="dv">2</span>) <span class="co">#theoretical quantiles</span>
se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p) <span class="op">/</span><span class="st"> </span>(n <span class="op">*</span><span class="st"> </span><span class="kw">dbeta</span>(Q, <span class="dv">3</span>, <span class="dv">2</span>))) <span class="co">#see Ch. 1</span></code></pre></div>
<p>The sample percentiles (first line) approximately match the Beta(3,2) percentiles computed by qbeta (second line), most closely near the center of the distribution. Larger numbers of replicates are required for estimation of percentiles where the density is close to zero.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">round</span>(<span class="kw">rbind</span>(Qhat, Q, se), <span class="dv">3</span>)</code></pre></div>
<pre><code>##        10%   20%   30%   40%   50%   60%   70%   80%   90%
## Qhat 0.338 0.435 0.500 0.564 0.616 0.676 0.731 0.789 0.870
## Q    0.320 0.418 0.492 0.555 0.614 0.671 0.728 0.788 0.857
## se   0.010 0.011 0.012 0.012 0.012 0.012 0.011 0.010 0.008</code></pre>
<p>(3)The histogram of the sample with the theoretical Beta(3,2) density superimposed is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(y,<span class="dt">prob =</span> <span class="ot">TRUE</span>)
<span class="kw">curve</span>(<span class="kw">dbeta</span>(x,<span class="dv">3</span>,<span class="dv">2</span>),<span class="dt">add=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The histogram and density plot suggests that the empirical and theoretical distributions approximately agree.</p>
</div>
<div id="problem-3.12" class="section level2">
<h2>Problem 3.12</h2>
<p>Simulate a continuous Exponential-Gamma mixture. Suppose that the rate parameter <span class="math inline">\(\Lambda\)</span> has <span class="math inline">\(Gamma(r,\beta)\)</span> distribution and Y has <span class="math inline">\(Exp(\Lambda)\)</span> distribution. That is, <span class="math inline">\((Y|\Lambda = \lambda) \sim f_Y (y|\lambda) = \lambda {e^{-\lambda y}}\)</span>. Generate 1000 random observations from this mixture with r = 4 and <span class="math inline">\(\beta = 2\)</span>.</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>The 1000 random observations are generated as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#generate a continuous Exponential-Gamma mixture</span>
n &lt;-<span class="st"> </span><span class="dv">1000</span>
r &lt;-<span class="st"> </span><span class="dv">4</span>
beta &lt;-<span class="st"> </span><span class="dv">2</span>
lambda &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n, r, beta) <span class="co">#lambda is random??which has Gamma(r, beta) distribution</span>

<span class="co">#now supply the sample of lambda??s as the Exponential parameter</span>
x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, lambda) <span class="co">#the mixture</span>
<span class="kw">plot</span>(<span class="kw">sort</span>(y)) <span class="co">#Output the sample</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3-20180928" class="section level2">
<h2>Exercise 3 (20180928)</h2>
</div>
<div id="problem-5.4" class="section level2">
<h2>Problem 5.4</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3) cdf, and use the function to estimate F(x) for <span class="math inline">\(x=0.1,0.2,\cdots,0.9\)</span>.Compare the estimates with the values returned by the <span class="math inline">\(\mathbf{pbeta}\)</span> function in <span class="math inline">\(\mathbf{R}\)</span>.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>The Beta(3,3) cdf satisfies <span class="math display">\[F(x)=\int_0^xf(t)dt=\int_0^x30t^2(1-t)^2dt\]</span> Then the problem is to estimate <span class="math inline">\(\theta=F(x)=\int_0^x30t^2(1-t)^2dt\)</span> for <span class="math inline">\(x\in (0,1]\)</span>. This can be accomplished by a change of variables. Making the substitution <span class="math inline">\(y=t/x\)</span>, we have <span class="math inline">\(dt=xdy\)</span> and <span class="math display">\[ \theta=\int_0^130x^3y^2{(1-xy)^2}dy\]</span> Thus,<span class="math inline">\(\theta=E_Y[30x^3Y^2(1-xY)^2]\)</span>, where the random variable Y has the Uniform(0,1) distribution. Generate iid Uniform(0,1) random numbers <span class="math inline">\(u_1,\cdots,u_m\)</span>, and compute <span class="math display">\[\hat{\theta}=\overline{g_m(u)}=\frac{1}{m}\sum_{i=1}^m30x^3{u_i^2}(1-u_ix)^2\]</span> The sample mean $ converges to <span class="math inline">\(E[\hat{\theta}]=\theta\)</span> as <span class="math inline">\(m\to \infty\)</span>. The function to compute a Monte Carlo estimate of the Beta(3, 3) cdf is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MC_beta &lt;-<span class="st"> </span><span class="cf">function</span>(x,m,...){
  u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co"># the random number of Uniform(0,1)</span>
  theta &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)){
    g &lt;-<span class="st"> </span><span class="dv">30</span><span class="op">*</span>x[i]<span class="op">^</span><span class="dv">3</span><span class="op">*</span>u<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x[i]<span class="op">*</span>u)<span class="op">^</span><span class="dv">2</span> <span class="co">#the function estimating theta</span>
    theta[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(g) 
  }
  <span class="kw">return</span>(theta)
}</code></pre></div>
<p>Then use the function to estimate F(x) for <span class="math inline">\(x=0.1,0.2,\cdots,0.9\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
m &lt;-<span class="st"> </span><span class="dv">100</span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)
cdf.hat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="dv">9</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>){
  cdf.hat[i] &lt;-<span class="st"> </span><span class="kw">MC_beta</span>(x[i],m) <span class="co">#estimate theta by MC_beta function</span>
}</code></pre></div>
<p>Now the estimates <span class="math inline">\(\hat{\theta}\)</span> for nine values of x are stored in the vector cdf.hat. Compare the estimates with the value F(x) computed (numerically) by the <span class="math inline">\(\mathbf{pbeta}\)</span> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## print the estimated and true value table
cdf &lt;-<span class="st"> </span><span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>) <span class="co"># true cdf values of beta(3,3)</span>
<span class="kw">print</span>(<span class="kw">round</span>(<span class="kw">rbind</span>(x,cdf.hat,cdf), <span class="dv">3</span>)) </code></pre></div>
<pre><code>##          [,1]  [,2]  [,3]  [,4]  [,5]  [,6]  [,7]  [,8]  [,9]
## x       0.100 0.200 0.300 0.400 0.500 0.600 0.700 0.800 0.900
## cdf.hat 0.007 0.063 0.161 0.331 0.547 0.752 0.851 0.881 0.996
## cdf     0.009 0.058 0.163 0.317 0.500 0.683 0.837 0.942 0.991</code></pre>
<p>The Monte Carlo estimates appear to be very close to the <span class="math inline">\(\mathbf{pbeta}\)</span> values. We can also prove it by figure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## plot the sample values and true values
<span class="kw">plot</span>(cdf.hat,<span class="dt">col=</span><span class="dv">2</span>)
<span class="kw">points</span>(<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>),<span class="dt">col=</span><span class="dv">4</span>,<span class="dt">pch=</span><span class="dv">3</span>) </code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAYFBMVEUAAAAAADoAAGYAAP8AOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC2/7a2///bkDrb/9vb////AAD/tmb/25D//7b//9v///89dwGyAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHWElEQVR4nO2djVLbOBRGTbPAbtJd2MWtt3GC3/8ta0kOASLpu7Z+jb8zU5imGamcka+upIvSDMRLU/o/UDsUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAgQWVBTPzvzrZSguM0l4Lg7qm8U5OA47AZliILsjG52+mtmQdcnPEpz6SglKFVzoew+/fUKBWl2N68wBn3gVhBnsQ9YBE2vUZCGgty8C8if/kF/pSCNbQQZKEhDQX6mGcsGBQ3XnMdGIkFt0zy8Po8riqcozaXlbVlhI42g7v7X6OhhGM6HfYTmIvM54Bzffb0hiaDX51FLf/cyGFWhzUXmJuDkF3Q+jE9W/+3ncPka1lxcLAHnODj9bG8EWQPO8Zh5FnuLQVpVcHMx8UZkCxubxZzrCifby4N8SY+F7Qnypc0WUgvqqpvFfAsvC1vctK9ZUKrmZkFBVzwJjpBEgvQUP+KIQLkE+VJkIYkSxWbKD/umZKLoXWQJSbfUMBRdalQrSC9WDUUXq9UKqmUEzc2abcwXdP7+or+7xoaiu6zBysaguVmzjeWCXDmyedPBzGKO8ZMvD5qV89iYK6i95sKOsRG530CyC7qOoEz9BlJAUBwyCJq/92NjgaBLfPHFoHj9BlJiBLX3v7qH4fTo2iyM228gJWLQYT/04+zkynAi9xtIEUFPw+mvn/pPhn4DKSBIpclqJqMg1xtVhtjuV/KIBbNkmm8f1EwWNIl9bUFZ+y3NFjftZ7FAENxOjdpvaZYkimHRZ2a/MwjfobewLFHM2K+cCDv0FpYlihn7FRNjf9XCkkTxIWe/YubWtQhZEIMCl6kz+xVTh6DLVkeNs1iEHXoLXylRDN+ht/CVBIWvTC0sF+Q91TB4olVsQXH2Vy0kOlmFkWoDI8jHdF6YcQRpKhA0ZomiY5/zQe0WbVLQXngu1t69bFHQ0InzoK7Zb1HQjJPV0+MfmQWlIGUe9PrsLLT/soJqXmqkYcEIMnO4+WUeSI2F5LNYvt2x6NhnC3vSlw0zX4VZxH5Ls+xkVdHy4NDxxl7PTZ03BlVSSB6BJdO8nsq84ydDIXmKpNDGWsuAk2yO2VhpIXma7VUbi4oXxlHhfHYUyUdQog16G8tK8AY1SjynP6kLyasWJMqDkhaSJ9tetbE8DxLsScfo107VMcg8P6fHopX2Vc9ip8fx4ZGtVcP7dbHqPChHcxQEoKBKoCAABQEoCEBBgHUIyjVlWVhHIfl2BC1rLtu6wsIaBOVbmVpYgaCMmz8Wahe0y7r5Y6F2QQNHEIYxCMFZDME8CEBB7ygow0YiQQHFC5sQFFC8UDIg26iteKHolG6jsuKFskmhjbIjyP25ZzN6S0uqGCQrXrjxsJERJC1esATkbcQgYXNWGZuYxWTNOR6nesKPJrUgZ6W9c6NnY4I+t/Ju076+gGyjuhhUG0UXq7UFZBtlF6uVxRsbxRarml1TPykECZYawR0VeVusJgSL1eCOVi2IIwiBF6vBHa1bEF6sBne0ckHpO6KgGt+WuImoHVFQjW9L3MTXhoIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQGyCNLHabJNWskNYeoGBMEF/Op20fBb6HMIen2+exn/u5IPFegFu7nqU9C8l9QY1GVjfbihHILM3a+SW1POByzInK3A1sy1h23wRz3ki0GSKyy7+3+hoNOfoutF1idI8NE448+OY1D/7cdBEtFW9IhpBEdp6uHBgjpVOiH5mJQ++C4bRS5BvSBGq+NagSD9U+OzbzViA29DUmQSJDmK1cFFIEirgZ8jI58Z/OQR1EmyoMut6OAnN2MHhmozJwgvN/aQRVAnj5V4BJkaE/iImREUdnWvIk8eJI8Egkxahap3hSbOltYTg6ZnRzTaJUuNXrZwacXrGx9crAIoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgPoE3VSshJewhEBBAAoCVCnofPjnYCrNuqa5+08J6kwtiyqpOx/Ci1rkVCpIleaPf1QRVN9Mf1HVUKpwav7VPCFUKmiva+hMGV07vaDr6fpvP75nfeIqFfSkaxFNheH4gglD2lcr+p2PeFQtqHsTdC2AjVA8P4uqBX0aQYrX57+DC1dnUbWgqRh8ekHT3f+PC1xjUrWg6RdSplnMROunCLXPc6hb0Mc8aBTT6hrpnGG6PkGVQUEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAX4DlaiO1RwyLX0AAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="problem-5.9" class="section level2">
<h2>Problem 5.9</h2>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}{e^{{-x^2}/{2\sigma^2}}},\ \ x\ge0,\sigma\gt0\]</span> Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, using antithetic variables. What is the percent reduction in variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1,X_2\)</span>.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>Illustrating Monte Carlo integration applied to estimate the standard normal cdf <span class="math display">\[F(x)=\int_0^x\frac{t}{\sigma^2}{e^{{-t^2}/{2\sigma^2}}}dt,\ \ x\ge0,\sigma\gt0\]</span> Repeat the estimation using antithetic variables. Making the substitution <span class="math inline">\(y=t/x\)</span>, we have <span class="math inline">\(dt=xdy\)</span> and <span class="math display">\[ \theta=\int_0^1\frac{x^2}{\sigma^2}ye^{-x^2y^2/2{\sigma^2}}dy\]</span> After change of variables, the target parameter is <span class="math inline">\(\theta=E_U[\frac{x^2}{\sigma^2}Ue^{-x^2U^2/2{\sigma^2}}]\)</span>, where U has the Uniform(0,1) distribution. Generate random numbers <span class="math inline">\(u_1,\cdots,u_{m/2}\sim Uniform(0,1)\)</span> and compute half of the replicates using <span class="math display">\[ Y_j=g^{(j)}(u)=\frac{x^2}{\sigma^2}u_je^{-\frac{x^2}{2\sigma^2}u_j^2},j=1,\cdots,m/2\]</span> but compute the remaining half of the replicates using <span class="math display">\[ Y'_j=g^{(j)}(u)=\frac{x^2}{\sigma^2}(1-u_j)e^{-\frac{x^2}{2\sigma^2}(1-u_j)^2},j=1,\cdots,m/2\]</span> The sample mean converges to <span class="math inline">\(E[\hat{\theta}]=\theta\)</span> as <span class="math inline">\(m\to \infty\)</span>.</p>
<p>(1)The function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution using antithetic variables is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MC.R &lt;-<span class="st"> </span><span class="cf">function</span>(x, sigma, <span class="dt">m =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>)
<span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(m<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span>
v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u
u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)
cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {
g &lt;-<span class="st"> </span>x[i]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x[i]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sigma<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>u<span class="op">^</span><span class="dv">2</span>)
cdf[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(g)
}
<span class="kw">return</span>(cdf)
}</code></pre></div>
<p>(2)Generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution using MC.R function above is below (choosing <span class="math inline">\(\sigma=2\)</span>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">9.5</span>, <span class="dt">length=</span><span class="dv">50</span>)
sigma &lt;-<span class="st"> </span><span class="dv">2</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
MC1 &lt;-<span class="st"> </span><span class="kw">MC.R</span>(x, sigma, <span class="dt">anti =</span> <span class="ot">FALSE</span>)<span class="co">#Using normal method</span>
<span class="kw">plot</span>(MC1)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">MC2 &lt;-<span class="st"> </span><span class="kw">MC.R</span>(x, sigma, <span class="dt">anti =</span> <span class="ot">TRUE</span>)<span class="co">#Using antithetic variables</span>
<span class="kw">plot</span>(MC2)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>(3)The function to compute the percent reduction in variance of <span class="math inline">\(\frac{X+X'}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for independent <span class="math inline">\(X_1,X_2\)</span> is</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rayleigh.MC &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, m) {
  rayleigh &lt;-<span class="st"> </span>antithetic &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
  u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)
  v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u
  rayleigh =<span class="st"> </span>sigma <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(u))
  antithetic =<span class="st"> </span>sigma <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(v))
  var1 &lt;-<span class="st"> </span><span class="kw">var</span>(rayleigh)
  var2 &lt;-<span class="st"> </span>(<span class="kw">var</span>(rayleigh) <span class="op">+</span><span class="st"> </span><span class="kw">var</span>(antithetic) <span class="op">+</span><span class="st"> </span>
<span class="st">               </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">cov</span>(rayleigh, antithetic)) <span class="op">/</span><span class="st"> </span><span class="dv">4</span>
  reduction &lt;-<span class="st"> </span>((var1 <span class="op">-</span><span class="st"> </span>var2) <span class="op">/</span><span class="st"> </span>var1)
  percent &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">formatC</span>(<span class="dv">100</span> <span class="op">*</span><span class="st"> </span>reduction, <span class="dt">format =</span> <span class="st">&quot;f&quot;</span>, 
                              <span class="dt">digits =</span> <span class="dv">2</span>), <span class="st">&quot;%&quot;</span>)
  <span class="kw">return</span>(<span class="kw">noquote</span>(percent))
}
<span class="kw">rayleigh.MC</span>(<span class="dt">sigma=</span><span class="dv">2</span>,<span class="dt">m=</span><span class="dv">10000</span>)</code></pre></div>
<pre><code>## [1] 97.35%</code></pre>
</div>
<div id="problem-5.13" class="section level2">
<h2>Problem 5.13</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ??close?? to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},\ \ x\gt1.\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>Choose importance function <span class="math display">\[f_1(x)=e^{-x},\ \ x\ge1\]</span> <span class="math display">\[f_2(x)=\pi(1+x^2)^{-1},\ \ x\ge1\]</span> Then <span class="math display">\[E[Z^1]=E[\frac{g(x)}{f_1(x)}]=E[\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2+x}]\]</span>. <span class="math display">\[E[Z^2]=E[\frac{g(x)}{f_2(x)}]=E[\frac{x^2}{\pi\sqrt{2\pi}(1+x^2)}e^{-x^2/2}]\]</span> Estimate <span class="math inline">\(E[Z^1]\)</span> and <span class="math inline">\(E[Z^2]\)</span> by simple Monte Carlo integration. That is, compute the average <span class="math display">\[\frac{1}{m}\sum_{i=1}^{m}Z_i^j=\frac{1}{m}\sum_{i=1}^{m}\frac{g(X_i)}{f_j(X_i)},\ \ j=1,2\]</span> where the random variables <span class="math inline">\(X_1,\cdots,X_m\)</span> are generated from the distribution with density <span class="math inline">\(f_j(x)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
(x<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span> <span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)
}

f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) { <span class="kw">exp</span>(<span class="op">-</span>x) }
f2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) { (pi <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) }

x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">1.1</span>, <span class="fl">9.5</span>, <span class="dt">length=</span><span class="dv">1000</span>)
<span class="kw">plot</span>(x,<span class="kw">g</span>(x),<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
<span class="kw">lines</span>(x,<span class="kw">f1</span>(x),<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">col=</span><span class="st">&quot;green&quot;</span>)
<span class="kw">lines</span>(x,<span class="kw">f2</span>(x),<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAaVBMVEUAAAAAADoAAGYAAP8AOpAAZrYA/wA6AAA6ADo6OpA6kNtmAABmADpmAGZmOpBmZmZmtttmtv+QOgCQOmaQZgCQ2/+2ZgC2/7a2///bkDrb2//b/9vb////AAD/tmb/25D//7b//9v////5UrYxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHxElEQVR4nO3dbZuiNgCFYXacdbdr39Z27dIOqPz/H1lDHAfRcJKQyAHP86HXdNsLmHtDQEAtGjVYMfUGsCcgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCBQGdNwWbS8/M20OX0FAZfHN/lC//7D8QoCO2wtL+fqWYWMYCwE6bL6//1g/zU6mEQQKnIPOQ0hzkKPDxh7Fnmb86DwIJiBQBFBdFJ9+pN8S0sKAdkXxbf/LW/eAv/SCgHanyXnXjh4d5u/Vjpv9VwPkOlFsj3FrW0FdHiBz9nP8t3GPoHZxZ6CqqgIW/uCyADXl+7ixVJ2lXP3FrGcglAeoKe3hqy5cc3QfiFYoE5Dn4jpArEI8QKRCuYFK11Gs/ecVEKcQ0QgS0M3iqjW/kIBAmYDgXQ0LVD0rEL6rYRZX9YEYhbIAeVyTvgYiHkKZXovBuxot0M0kRCg04QgyHk8K5HFXwwLNYBLKdBSDdzWKdg+7ADXPBuS1uKq5AeITmvZE8eYwJqD+4tbs+9iDgW4v9bLvY1OPIAGhxbFPQjRArJMQHRCb0ORA7JMQDRDrPiYgEB8QmdD0QOSTEBEQ5z7GA0Q6CRECcQkRAHFPQkxAlPsYERDnJMQIRCU0+QUzk4DA4pivCVEBMU5ClEBMQhmfk67h4y+XnhKovSvvfK/GXSDGSSgb0Jlm8En7S8STUARQfT5Qu9/HY4D2X9r/PvT4y0fEk1Ao0GFTfLY/HbfOGSZ4BBHvY4FAh9+6Jtf/1vnz9tmOz83tezVc610MkHcno08/Bt707ADim4TCgdp3OSVf74KADhs7CR3/GvOZCg4gvn0s6ihm3utUjvtklyUDnZ8SH/eRCjfrZd3HoiZpIzT0bub3JxQHnrV3AdE9MR0DtCuKP7eDnzpx3KL9DwHRCMVM0oV9KTpkcNx+9ljc6tTlT0iHUATQ73boDB/FHO9WvbqiuFp1hRYDlGy9q9WV0DKA/F5q+C3O2PAPoSwvVv0Wd/ZZGFDjc7mj09Cbemexj015TboH1BNKu77oJr1oP4chFHUeVITsZAOLm8MQipqD7Inid+fVMN839S4T6P0kuXx9c356kt+bemexj8XsYnbPql9+uq7Ie76pdxZDKGYE2d/ejCAHkOebehswhHw3LWtj5iDnK1LvETQ8hHw3LWsxh/n2OHYaGTvnFOz1pt42+iGU6TzI5029bfRDaOqnO1ZDQyjtKuOaGqgvtGYTmv4RPPIhNPkIspeEHEJp1xnV9ECuIUTy6YpEQJxDiADo3jxd0QwhBqCBeTrtSmOiArpzqE+71ogogAaE0q41Ig4gt1DatUbEBmSFiIYQCZBbKO1qw2MBohWiAeoJCej2jxxCadcbHBFQR8gQkQgxAVEKUQF1hVYkQlxA10L2MwSraYmmv6J4XVdodfGZUIhsBPWEVuvJdzM6oJ5QxyjtBviWCcjv6Q5HLqKgLUhVHiDfpzsc9YUuRiHbkKgsQP735l3dEp2RArYiTVmA/J/ucHZPyCIFbEeKSEdQ4yQySgGbMrpcc5Dv0x1DuYlMIdszoqmf7gANGz0Ciu88qJ+HUU4rfqCmqgKMkoMxnij2M/egY41G01GeKPY7PxacGMmPkfcw36366NFCrCeKvaqrTqeLDxOaxwjqC318H8c8gdwniuHfEHypT9RRykdFf6J41R2ivlJisPUszoM63Scahhphtw7ZUAog0xBSjNZAQRsa+RsNfxHtDJpsBM2miYDGrMVvUxIuKt36HrOWJQDBF6tj1rIAIPxidcxa5g/k8VJjzFrmD+TxYnXMWuYPpBGEwnc1xqxlAUD4xeqYtSwB6AkTEEhAIAGBBAQSEEhAIAGBBAQSEEhAIAGBBATKD9Rex/a5OrLD1wj2X4oCfOS3uSgz6rMye2UHOm4//ThtM/y1mhpfRKlP/8f711s4K9tvRkkmlB3IfluS607sR4cNBLJXNMGi7Gf47fBfiGcPmoNq850dg5WvfyOg/Ve0kGa2QO6PHjx3+uXhHFS//LPB09ncdrE2eA3b7D0QqP3WGPjFDOaTw+F49e8hQDWco81dEgzU/t7ojpMZrPsv475gptMjgPA9kHZ2wUAtzfk78pyL8jwo+PYAoBKfBZXnZ1KGZw47dsBUbQ8H+KDgW36g0nfChCPI3tkFu5gdQYF3fgd6wHmQ73SAz6TNTNW5vetYzMzmoPPe4zHkPV5q1D6vWnaeL2380otVkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBAAgIJCCQgkIBA7EDmWbrDJt3TLMGxA5nnpQI/ByNt7EDm4ehf0z3UGx49ULPzeJ9HxviBEj41HxM90HH7R7InVmOiBypf/0PPtWaNHcg8G53uoeeI2IF27aPRE07T7ECTJyCQgEACAgkIJCCQgEACAgkIJCCQgEACAgkIJCCQgEACAgkIJCCQgEACAgkIJCCQgEACAv0PybZbv7TOY6QAAAAASUVORK5CYII=" /><!-- --></p>
<p>As we can see from the figure, importance function <span class="math inline">\(f_1\)</span> is closer to g than <span class="math inline">\(f_2\)</span>, so <span class="math inline">\(f_1\)</span> should produce the smaller variance in estimating <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling. We can also prove it by data. The specific code is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">100</span>
theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)

x1 &lt;-<span class="st"> </span><span class="kw">rexp</span>(m) <span class="co"># the random variable produced by f1</span>
x2 &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(m) <span class="co"># the random variable produced by f2</span>
x2[<span class="kw">which</span>(x2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># to catch overflow errors in g(x)</span>


fg1 &lt;-<span class="st"> </span><span class="kw">g</span>(x1) <span class="op">/</span><span class="st"> </span><span class="kw">f1</span>(x1)
fg2 &lt;-<span class="st"> </span><span class="kw">g</span>(x2) <span class="op">/</span><span class="st"> </span><span class="kw">f2</span>(x2)

fg &lt;-<span class="st"> </span><span class="kw">cbind</span>(fg1, fg2)

theta.hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg1)
se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg1)
theta.hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg2)
se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg2)
<span class="kw">rbind</span>(theta.hat, se)</code></pre></div>
<pre><code>##                [,1]     [,2]
## theta.hat 0.4110298 0.447654
## se        0.6117304 1.045610</code></pre>
<p>We can see the variance of the importance function <span class="math inline">\(f_1\)</span> is smaller than <span class="math inline">\(f_2\)</span>.</p>
</div>
<div id="problem-5.14" class="section level2">
<h2>Problem 5.14</h2>
<p>Obtain a Monte Carlo estimate of <span class="math display">\[\int_1^\infty\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<p>Choose importance function <span class="math display">\[f_1(x)=e^{-x},\ \ x\ge1\]</span> <span class="math display">\[f_2(x)=\pi(1+x^2)^{-1},\ \ x\ge1\]</span> The implements are as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) { (x<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">2</span> <span class="op">*</span>pi) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)}
<span class="kw">integrate</span>(g, <span class="dv">1</span>, <span class="ot">Inf</span>) <span class="co">#Compute the integral from 0 to Inf of g</span></code></pre></div>
<pre><code>## 0.400626 with absolute error &lt; 5.7e-07</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) { <span class="kw">exp</span>(<span class="op">-</span>x) }
f2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) { (pi <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) }

m &lt;-<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span>
x1 &lt;-<span class="st"> </span><span class="kw">rexp</span>(m)
x2 &lt;-<span class="st"> </span><span class="kw">rcauchy</span>(m)
x2[<span class="kw">which</span>(x2 <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)] &lt;-<span class="st"> </span><span class="dv">1</span> <span class="co"># to catch overflow errors in g(x)</span>

fg &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">g</span>(x1) <span class="op">/</span><span class="st"> </span><span class="kw">f1</span>(x1), <span class="kw">g</span>(x2) <span class="op">/</span><span class="st"> </span><span class="kw">f2</span>(x2))

theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)
theta.hat &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(fg[,<span class="dv">1</span>]), <span class="kw">mean</span>(fg[,<span class="dv">2</span>]))
se &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sd</span>(fg[,<span class="dv">1</span>]), <span class="kw">sd</span>(fg[,<span class="dv">2</span>]))
<span class="kw">rbind</span>(theta.hat, se)</code></pre></div>
<pre><code>##                [,1]     [,2]
## theta.hat 0.3672693 0.381209
## se        0.5719156 0.930318</code></pre>
<p>We can see the estimation with the importance function <span class="math inline">\(f_1\)</span> is better than <span class="math inline">\(f_2\)</span>.</p>
</div>
<div id="exercise-4-20181012" class="section level2">
<h2>Exercise 4 (20181012)</h2>
</div>
<div id="problem-6.9" class="section level2">
<h2>Problem 6.9</h2>
<p>Let X be a non-negative random variable with <span class="math inline">\(\mu=E[X]&lt;\infty\)</span>. For a random sample <span class="math inline">\(x_1,\cdots,x_n\)</span> from the distribution of X, the Gini ratio is defined by <span class="math display">\[G=\frac{1}{2n^2\mu}\sum_{j=1}^{n}\sum_{i=1}^{n}|x_i-x_j|\]</span> The Gini ratio is applied in economics to measure inequality in income distribution . Note that G can be written in terms of the order statistics x(i) as <span class="math display">\[G=\frac{1}{n^2\mu}\sum_{i=1}^{n}(2i-n-1)x_{(i)}\]</span> If the mean is unknown, let <span class="math inline">\(\hat{G}\)</span> be the statistic G with ?? replaced by <span class="math inline">\(\bar{x}\)</span>. Estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat{G}\)</span> if X is standard lognormal. Repeat the procedure for the uniform distribution and Bernoulli(0.1). Also construct density histograms of the replicates in each case.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<p>(1)When X is standard lognormal, estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat{G}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># Number of Monte Carlo trials</span>
n &lt;-<span class="st"> </span><span class="dv">100</span>
<span class="kw">set.seed</span>(<span class="dv">1</span>)
G.hat1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co"># Storage for test statistics from the MC trials</span>
g1 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
Id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n
## Start the simulation
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x1 &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(n) <span class="co"># x1 generated from standard lognormal distribution</span>
  mu_hat1 &lt;-<span class="st"> </span><span class="kw">mean</span>(x1) <span class="co"># The estimation of mu</span>
  x1_order &lt;-<span class="st"> </span><span class="kw">sort</span>(x1) <span class="co"># x1_order is the order statistic of x1</span>
  G.hat1[i] &lt;-<span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>Id <span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">%*%</span>x1_order<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span> <span class="op">*</span>mu_hat1)<span class="co"># Estimate the value of G</span>
}
<span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(G.hat1),<span class="kw">median</span>(G.hat1))) <span class="co"># the mean and median of G.hat1</span></code></pre></div>
<pre><code>## [1] 0.5128181 0.5107049</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">quantile</span>(G.hat1,<span class="dt">probs=</span><span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))) <span class="co"># the deciles of G.hat1</span></code></pre></div>
<pre><code>##       10%       20%       30%       40%       50%       60%       70% 
## 0.4638178 0.4805694 0.4902141 0.5006500 0.5107049 0.5203018 0.5321593 
##       80%       90%      100% 
## 0.5451978 0.5664711 0.6460172</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G.hat1,<span class="dt">prob =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>(2)When X is uniform, estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat{G}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># Number of Monte Carlo trials</span>
n &lt;-<span class="st"> </span><span class="dv">100</span>
<span class="kw">set.seed</span>(<span class="dv">12</span>)
G.hat2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co"># Storage for test statistics from the MC trials</span>
g2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
Id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n
## Start the simulation
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n) <span class="co"># x2 generated from uniform distribution</span>
  mu_hat2 &lt;-<span class="st"> </span><span class="kw">mean</span>(x2) <span class="co"># The estimation of mu</span>
  x2_order &lt;-<span class="st"> </span><span class="kw">sort</span>(x2) <span class="co"># x2_order is the order statistic of x2</span>
  G.hat2[i] &lt;-<span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>Id <span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">%*%</span>x2_order<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span> <span class="op">*</span>mu_hat2)<span class="co"># Estimate the value of G</span>
}
<span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(G.hat2),<span class="kw">median</span>(G.hat2))) <span class="co"># the mean and median of G.hat2</span></code></pre></div>
<pre><code>## [1] 0.3309144 0.3305731</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">quantile</span>(G.hat2,<span class="dt">probs=</span><span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))) <span class="co"># the deciles of G.hat2</span></code></pre></div>
<pre><code>##       10%       20%       30%       40%       50%       60%       70% 
## 0.2993108 0.3098177 0.3193112 0.3247008 0.3305731 0.3364077 0.3429928 
##       80%       90%      100% 
## 0.3513647 0.3620325 0.4237325</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G.hat2,<span class="dt">prob =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>(3)When X is Bernoulli(0.1), estimate by simulation the mean, median and deciles of <span class="math inline">\(\hat{G}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># Number of Monte Carlo trials</span>
n &lt;-<span class="st"> </span><span class="dv">100</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
G.hat3 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co"># Storage for test statistics from the MC trials</span>
g3 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
Id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>n
## Start the simulation
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x3 &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n,<span class="dv">1</span>,<span class="fl">0.1</span>) <span class="co"># x3 generated from Bernoulli(0.1) distribution</span>
  mu_hat3 &lt;-<span class="st"> </span><span class="kw">mean</span>(x3) <span class="co"># The estimation of mu</span>
  x3_order &lt;-<span class="st"> </span><span class="kw">sort</span>(x3) <span class="co"># x3_order is the order statistic of x3</span>
  G.hat3[i] &lt;-<span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>Id <span class="op">-</span>n<span class="op">-</span><span class="dv">1</span>)<span class="op">%*%</span>x3_order<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span> <span class="op">*</span>mu_hat3)<span class="co"># Estimate the value of G</span>
}
<span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(G.hat3),<span class="kw">median</span>(G.hat3))) <span class="co"># the mean and median of G.hat3</span></code></pre></div>
<pre><code>## [1] 0.90061 0.90000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">quantile</span>(G.hat3,<span class="dt">probs=</span><span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))) <span class="co"># the deciles of G.hat1</span></code></pre></div>
<pre><code>##  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% 
## 0.86 0.88 0.89 0.89 0.90 0.91 0.92 0.93 0.94 0.97</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(G.hat3,<span class="dt">prob =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="problem-6.10" class="section level2">
<h2>Problem 6.10</h2>
<p>Construct an approximate 95% confidence interval for the Gini ratio <span class="math inline">\(\gamma=E[G]\)</span> if X is lognormal with unknown parameters. Assess the coverage rate of the estimation procedure with a Monte Carlo experiment.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<p>(1)Since X is lognormal,<span class="math inline">\(ln(x)\sim Norm(\mu,\sigma)\)</span>, then <span class="math display">\[E(x)=e^{\mu+\sigma^2/2}\]</span> using SLLN we have, <span class="math inline">\(E(G)\to G\)</span> as sample number <span class="math inline">\(n\to \infty\)</span></p>
<p>So, we will construct a confidence interval of <span class="math inline">\(G\)</span> to approximate the confidence interval of <span class="math inline">\(E(G)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gini &lt;-<span class="st"> </span><span class="cf">function</span>(x,<span class="dt">mu=</span><span class="kw">mean</span>(x)){
  <span class="kw">mean</span>((<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)<span class="op">*</span><span class="dv">2</span><span class="op">-</span><span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">sort</span>(x))<span class="op">/</span>(mu<span class="op">*</span><span class="kw">length</span>(x))
}
  
<span class="co"># repeat for different parameter</span>
rep1 &lt;-<span class="st"> </span><span class="dv">5</span>
coverage_G &lt;-<span class="st"> </span>coverage &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>rep1

<span class="cf">for</span>(ii <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>rep1){
  sigma &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">rnorm</span>(<span class="dv">1</span>))<span class="co"># a large sigma will crash the estimate of E(G) since rep1 too small</span>

  <span class="co"># repeat for E(G)</span>
  rep1 &lt;-<span class="st"> </span><span class="dv">1000</span>
  interval &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>,rep1,<span class="dv">2</span>)<span class="co"># produce rep*2 matrix</span>
  G &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>rep1
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>rep1){
    <span class="co"># generate X with a unknown parameter sigma.</span>
    len &lt;-<span class="st"> </span><span class="dv">100</span>
    x &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(len,<span class="dv">0</span>,sigma)<span class="co">#set mu=0 since mu is unimportant.</span>
    G[i] &lt;-<span class="st"> </span><span class="kw">gini</span>(x,<span class="kw">exp</span>(sigma<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>))

    <span class="co"># estimate E(G)</span>

    ## estimate sigma_hat
    sigma_hat &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">log</span>(x))

    <span class="co"># construct confidence interval</span>
    interval[i,]=<span class="kw">pnorm</span>(<span class="kw">sqrt</span>(sigma_hat<span class="op">*</span>(len<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="kw">sapply</span>(<span class="kw">c</span>(<span class="fl">0.975</span>,<span class="fl">0.025</span>),qchisq,<span class="dt">df=</span>len<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>))<span class="op">*</span><span class="dv">2</span><span class="op">-</span><span class="dv">1</span>
  }
  coverage[ii]=<span class="kw">sum</span>(<span class="kw">mean</span>(G)<span class="op">&lt;</span>interval[,<span class="dv">2</span>]<span class="op">&amp;</span><span class="kw">mean</span>(G)<span class="op">&gt;</span>interval[,<span class="dv">1</span>])
  coverage_G[ii]=<span class="kw">sum</span>(<span class="kw">pnorm</span>(sigma<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>))<span class="op">*</span><span class="dv">2</span><span class="op">-</span><span class="dv">1</span><span class="op">&lt;</span>interval[,<span class="dv">2</span>]<span class="op">&amp;</span><span class="kw">pnorm</span>(sigma<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span>))<span class="op">*</span><span class="dv">2</span><span class="op">-</span><span class="dv">1</span><span class="op">&gt;</span>interval[,<span class="dv">1</span>])
}

<span class="kw">print</span>(interval[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,])<span class="co">#the first 20 approximate 95% confidence interval</span></code></pre></div>
<pre><code>##             [,1]      [,2]
##  [1,] 0.10197869 0.1346501
##  [2,] 0.10293958 0.1359135
##  [3,] 0.10564094 0.1394647
##  [4,] 0.10995287 0.1451305
##  [5,] 0.10219376 0.1349329
##  [6,] 0.09585442 0.1265940
##  [7,] 0.10177086 0.1343768
##  [8,] 0.09340696 0.1233730
##  [9,] 0.10282083 0.1357574
## [10,] 0.09630464 0.1271865
## [11,] 0.10131264 0.1337742
## [12,] 0.09951566 0.1314108
## [13,] 0.10321641 0.1362775
## [14,] 0.10334994 0.1364531
## [15,] 0.09103505 0.1202505
## [16,] 0.10202654 0.1347130
## [17,] 0.09397601 0.1241220
## [18,] 0.08422758 0.1112845
## [19,] 0.09812666 0.1295837
## [20,] 0.09277113 0.1225360</code></pre>
<p>Then check if there are errors in construct CI of G:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coverage_G<span class="op">/</span>len</code></pre></div>
<pre><code>## [1] 9.49 9.47 9.49 9.32 9.53</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coverage<span class="op">/</span>len<span class="co"># this is the &quot;true&quot; coverage rate, may not the accuracy one since we could not calculate E(G) through sigma and n.</span></code></pre></div>
<pre><code>## [1] 9.48 9.45 9.49 9.16 9.48</code></pre>
</div>
<div id="problem-6.b" class="section level2">
<h2>Problem 6.B</h2>
<p>Tests for association based on Pearson product moment correlation <span class="math inline">\(\rho\)</span>, Spearman??s rank correlation coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall??s coefficient <span class="math inline">\(tau\)</span>, are implemented in <span class="math inline">\(\mathbf{cor.test}\)</span>. Show (empirically) that the nonparametric tests based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(tau\)</span> are less powerful than the correlation test when the sampled distribution is bivariate normal. Find an example of an alternative (a bivariate distribution (X,Y) such that X and Y are dependent) such that at least one of the nonparametric tests have better empirical power than the correlation test against this alternative.</p>
</div>
<div id="answer-13" class="section level2">
<h2>Answer</h2>
<p>(1)Verify the nonparametric tests based on <span class="math inline">\(\rho s\)</span> or <span class="math inline">\(tau\)</span> less powerful than the correlation test when the sampled distribution is bivariate normals code is as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># Number of Monte Carlo trials</span>
n &lt;-<span class="st"> </span><span class="dv">100</span>
alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>
p_rho &lt;-<span class="st"> </span>p_rhos &lt;-<span class="st"> </span>p_tau &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span>
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)
  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n) <span class="co"># x,y value sample from bivariate normal distribution</span>
  rho &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x,y,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)
  rhos &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x,y,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>)
  tau &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x,y,<span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)
  p_rho[i] =<span class="st"> </span>rho<span class="op">$</span>p.value
  p_rhos[i] =<span class="st"> </span>rhos<span class="op">$</span>p.value
  p_tau[i] =<span class="st"> </span>tau<span class="op">$</span>p.value
}
##the power
<span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p_rho),<span class="kw">mean</span>(p_rhos),<span class="kw">mean</span>(p_tau)),<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.502 0.495 0.496</code></pre>
<p>We can see, the observed Type I error rate of Pearson product moment correlation (rho) larger of the error of Spearmans rank correlation coefficient (rhos) and Kendalls coefficient (tau).</p>
<p><br /><br /></p>
<p>(2)If we try without a loop, we can get Spearmans rank correlation coefficient (rhos) and Kendalls coefficient (tau) have better empirical power than the correlation test (rho).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># Number of Monte Carlo trials</span>
n &lt;-<span class="st"> </span><span class="dv">100</span>
p_rho &lt;-<span class="st"> </span>p_rhos &lt;-<span class="st"> </span>p_tau &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span>
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)
  y[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
  y[<span class="dv">1</span>] &lt;-<span class="st"> </span>x<span class="op">%*%</span>y<span class="op">/</span>(<span class="op">-</span>x[<span class="dv">1</span>])
  rho &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x,y,<span class="dt">alternative =</span> <span class="st">&quot;less&quot;</span>,<span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)
  rhos &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x,y,<span class="dt">alternative =</span> <span class="st">&quot;less&quot;</span>,<span class="dt">method =</span> <span class="st">&quot;kendall&quot;</span>)
  tau &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x,y,<span class="dt">alternative =</span> <span class="st">&quot;less&quot;</span>,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)
  p_rho[i] =<span class="st"> </span>rho<span class="op">$</span>p.value
  p_rhos[i] =<span class="st"> </span>rhos<span class="op">$</span>p.value
  p_tau[i] =<span class="st"> </span>tau<span class="op">$</span>p.value
}
##the power
<span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p_rho),<span class="kw">mean</span>(p_rhos),<span class="kw">mean</span>(p_tau)),<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] 0.5 1.0 1.0</code></pre>
</div>
<div id="exercise-5-20181102" class="section level2">
<h2>Exercise 5 (20181102)</h2>
</div>
<div id="problem-7.1" class="section level2">
<h2>Problem 7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
</div>
<div id="answer-14" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(bootstrap) <span class="co"># for the law data</span>

<span class="kw">set.seed</span>(<span class="dv">1</span>)

##Jacknife estimate of bias
n &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)
theta.hat &lt;-<span class="st">  </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)
theta.hat</code></pre></div>
<pre><code>## [1] 0.7763745</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#compute the jackknife replicates, leave-one-out estimates</span>
theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n) <span class="co">#storage for replicates</span>

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)
{
  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT[<span class="op">-</span>i] , law<span class="op">$</span>GPA[<span class="op">-</span>i])
}
bias &lt;-<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)
bias</code></pre></div>
<pre><code>## [1] -0.006473623</code></pre>
<p>Next we estimate the standard error of the correlation statistic:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Jacknife estimate of standard error
se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="op">-</span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>)) 
<span class="kw">print</span>(se) </code></pre></div>
<pre><code>## [1] 0.1425186</code></pre>
<p>So the Jacknife estimate of bias is -0.0064, and the standard error of the correlation statistic is 0.1425.</p>
</div>
<div id="problem-7.5" class="section level2">
<h2>Problem 7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-15" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(boot)
<span class="kw">attach</span>(aircondit)
x &lt;-<span class="st"> </span>hours 
gaptime.hat =<span class="st"> </span><span class="kw">mean</span>(x) <span class="co"># MLE of 1/lambda </span>
boot.mean &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">mean</span>(x[i])
ci.norm&lt;-ci.basic&lt;-ci.perc&lt;-ci.bca&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,<span class="dv">1</span>,<span class="dv">2</span>)
<span class="kw">set.seed</span>(<span class="dv">123</span>)
de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>x,<span class="dt">statistic=</span>boot.mean, <span class="dt">R =</span> <span class="dv">999</span>)
ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))
ci</code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 999 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = de, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 36.8, 183.0 )   ( 30.8, 171.6 )  
## 
## Level     Percentile            BCa          
## 95%   ( 44.6, 185.4 )   ( 54.9, 230.9 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>We see the intervals are quite disparate. A primary reason is that the bootstrap distribution is still skewed, affecting the simpler methods and their appeal to the Central Limit Theorem. For example the code below gives the following histogram of the boostrapped <span class="math inline">\(1/{\lambda}\)</span> values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(de<span class="op">$</span>t, <span class="dt">main=</span><span class="st">''</span>, <span class="dt">xlab=</span><span class="kw">expression</span>(<span class="dv">1</span><span class="op">/</span>lambda), <span class="dt">prob=</span>T)
<span class="kw">points</span>(de<span class="op">$</span>t0, <span class="dv">0</span>, <span class="dt">pch =</span> <span class="dv">19</span>) </code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAdVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZrY6kLY6kNtmAABmADpmOgBmZrZmkNtmtv+QOgCQkLaQkNuQtv+Q2/+2ZgC2Zma2kDq22/+2///bkDrbkGbbtpDb////tmb/25D/27b//7b//9v///+vMMo8AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAG10lEQVR4nO2dYXubNhRGSZN03WZva7Mt3hbW4Dn+/z9xCExM2sARAiEJvedTzSNfXU4lkGQFirMYpQidQOxIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgQEFVS8IWQmwyyTluNZFoMf4mHhtCRo0XASNKW0BEFpCYLSEgSlI73nRyTIPY5PJAiQIECCAAkCJAiQIGBtQcOjHQn6voAEQQEJggISBAUkCApIEBTIR5D9MsXGBR0+PJ2P90Vx8+gazlZQNItDkypv/Hys5Zz2XxzDubSgZASd9rta0p35Z3n77BYuXUGnfXEHZU27eXnYmX9WdVsaDYf1uX5Ym17lZd3bd6OFTespc21BDeDotP/w1DShaugqvXVBraKB7mOo2tvKYGfcuCBz+uYyM9B/pobDAmkJqq/SRWtm6Ao8KZxNgaQEnfaDo78rLw9tFxs0uGVBv7R+xppP2V3Bq6FLeQaCymFBlzFQUyq32/zhOvEZvs33JhgZDhS7FjRCzi3IjrK4NKEcr0FWmKGAYXCgtFVB9Ty9O/excbRtONsC6QhaL9zGBeU8UGyWw8qRy8t5ZKDod006EkGH2+fj/d1lxfBd8r7Nm1FgVd/GR6YamQ8U67M3i/Kaaryl18XuTvvb59N+ZGU674FiPRC6eXx5GF25z3aguF44CZpSIC1BOAjsM3Qp37Kgw6xJ2HfhbAokJaj5XXm5cFYFEhM0sB/BLZxVgaQEwQ2+K5TxZLUqsAmF+lUj5GahXhfDBbMophrBBFkQxWQ1ZkG5t6C6k90+H8Zu9jFMVsMJqm4eSzObHzMUwWQ1mCDTf0zHGVkPmhLOqkBSgswV2Aiasffl/H76Ln8BFaGgrgUdXHZPjY5SlnUS+hpU8nDRLtzAsYQFtVdgi11UluHeP5ayIF/hJAjCbURQO8Rx39/6TbihY8kKOrQX5xL22tuGGzyWqqDXrfPHe93F3tDW11stG/lt3jrcyLFEBfVmYMtPNbYhCFd6poQbOSZBcEyC4JgEwbH5H1Zewe8EXeuMXRBVtzBpTzUkaMoHP0gQIEGABAHLVBFqTTo6QU67OzIS5La7Ix9Bjr/N5yPIcXdHPoLUggi33R0ZCXLb3ZGTIKdwEgThfAryvzi0oYFiBILiHiiGFxT5bT68IOuBYjF8bdi0IOsWVLxzbOUPi+FloJitINuBYiBBXu75XsZBzoJeTyye5hSVoOt/faqCLAeKjoJ6nWPh/jaj8y0zUPym9pHsIsCfIIvb/CycTsA3Cw8UZyYTn5+oWlDvLhYPCw8Ut8fCA8WRisIzOecmb6dv+aiICvgPsOC3fFS0LUHTNwtnJshDRRI0s4AEBQ+wwLcmPYRpYkVbEMS/asyoaAOCZk01chDkfbIaI3FNViNEk1VgtclqqkS3/hIbEgRIECBBgAQBEgRIECBBgAQB3gW1g2/zQJDK5flWxx+eZgRp1q92s7LwLqh5N7TBPGBm8P2sQ5g3u7oHeXmoi5bGi3sW3gV1CyPtUsDEZ8tUl8VLxyDts37MLzDuWXgXVF6SuSZrT1Xs2jObE6RpMO4BvAs6fGovA20jn7zQ1n5hVhDzsH73AL4Fmbe91DnuLh1/8kWoOZdZQcza1YwA69zm69OcI2hOkOr6YmqnAOsIqrv+rC7mHqS/9ukUYCVBHx+drq9vBTkEefNUP6csfAtqM6ou76mf/gi5RpBzkG4RfUYW/u9iJhnznHOngWJ3F3MLcrzv2o97Fv67mHlL8uUhlg5TjUsXcwtStj8xmC84Z6HJKiBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgRIECBBgAQBEgSkIShglhIUb9X2hExSgiKue5x2d2KDBL3DZXdiQ5Pk38XPIfKIVVDV+9PqJsfj5/O/894B60akgl53Jxq6HE9/BMgkUkHn/s6gLsfjTwHSSEDQa4pO7+meS0KCjvc/Bvhb9IQElbdf/1w/jXQEnfZfQlyl4xd0bUDPL7+vn0Yygpp35f71z/G3ldNIRlDz8b9fp+9ynEm8gjoCZxi9oNAJhq4fCZ1g6PqjR4IACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCJAgQIIACQIkCPgfAnnwVj3GunAAAAAASUVORK5CYII=" /><!-- --></p>
<p>The BCa interval incorporates an acceleration adjustment for skew, and may be preferred here.</p>
</div>
<div id="problem-7.8" class="section level2">
<h2>Problem 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-16" class="section level2">
<h2>Answer</h2>
<p>The jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(bootstrap)
<span class="kw">attach</span>(scor)

##define the core function 
theta =<span class="st"> </span><span class="cf">function</span>(x){
 <span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values)
 } <span class="co">#end function </span>

n &lt;-<span class="st"> </span><span class="kw">length</span>(scor[,<span class="dv">1</span>])
x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(scor)
theta.hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(<span class="kw">eigen</span>(<span class="kw">cov</span>(x))<span class="op">$</span>values)
theta.jack &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { 
  theta.jack[i] &lt;-<span class="st"> </span><span class="kw">theta</span>( x[<span class="op">-</span>i,] ) 
}
bias.jack &lt;-<span class="st"> </span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>( <span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat )
theta.bar &lt;-<span class="st"> </span><span class="kw">mean</span>(theta.jack)
se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>( (n<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">mean</span>( (theta.jack<span class="op">-</span>theta.bar)<span class="op">^</span><span class="dv">2</span> ) )
<span class="kw">print</span>( <span class="kw">list</span>(<span class="dt">theta.hat=</span><span class="kw">theta</span>(scor), <span class="dt">bias=</span>bias.jack, <span class="dt">se=</span>se.jack) )</code></pre></div>
<pre><code>## $theta.hat
## [1] 0.619115
## 
## $bias
## [1] 0.001069139
## 
## $se
## [1] 0.04955231</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">detach</span>(package<span class="op">:</span>bootstrap)</code></pre></div>
<p>So, <span class="math inline">\(\hat{bias}_{jack}(\hat{\theta})=0.0011\)</span>,and <span class="math inline">\(\hat{se}_{jack}(\hat{\theta})=0.04955\)</span>.</p>
</div>
<div id="problem-7.11" class="section level2">
<h2>Problem 7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-17" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DAAG)
<span class="kw">attach</span>(ironslag)
<span class="kw">set.seed</span>(<span class="dv">1</span>)

n &lt;-<span class="st"> </span><span class="kw">length</span>(ironslag[,<span class="dv">1</span>])
a &lt;-<span class="st"> </span><span class="kw">array</span>( <span class="dt">dim =</span> <span class="kw">c</span>(n, n<span class="op">-</span><span class="dv">1</span>) )
e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span>a

<span class="co"># for n-fold cross validation</span>
<span class="co"># fit models on leave-two-out samples</span>

<span class="cf">for</span>( j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { <span class="co"># outer 1 to n</span>
  z &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>j] <span class="co">#z is magnetic</span>
  u &lt;-<span class="st"> </span>chemical[<span class="op">-</span>j] <span class="co">#u is chemical</span>
  <span class="cf">for</span>( k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(n<span class="op">-</span><span class="dv">1</span>) ) { <span class="co">#inner 1 to n-1</span>
    y &lt;-<span class="st"> </span>z[<span class="op">-</span>k] <span class="co">#magnetic inner loop</span>
    x &lt;-<span class="st"> </span>u[<span class="op">-</span>k] <span class="co">#chemical inner loop</span>

    L1 &lt;-<span class="st"> </span><span class="kw">lm</span>( y <span class="op">~</span><span class="st"> </span>x )
    yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>u[k] <span class="co">#mutatis mutandis u for chemical</span>
    e1[j,k] &lt;-<span class="st"> </span>z[k] <span class="op">-</span><span class="st"> </span>yhat1 <span class="co"># mutatis mutandis z for magnetic</span>

    L2 &lt;-<span class="st"> </span><span class="kw">lm</span>( y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) )
    yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>u[k] <span class="op">+</span>
<span class="st">             </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>u[k]<span class="op">^</span><span class="dv">2</span>
    e2[j,k] &lt;-<span class="st"> </span>z[k] <span class="op">-</span><span class="st"> </span>yhat2

    L3 &lt;-<span class="st"> </span><span class="kw">lm</span>( <span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x )
    logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>u[k]
    yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>( logyhat3 )
    e3[j,k] &lt;-<span class="st"> </span>z[k] <span class="op">-</span><span class="st"> </span>yhat3

    L4 &lt;-<span class="st"> </span><span class="kw">lm</span>( <span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x) )
    logyhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(u[k])
    yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>( logyhat4 )
    e4[j,k] &lt;-<span class="st"> </span>z[k] <span class="op">-</span><span class="st"> </span>yhat4
  }
}

<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)) </code></pre></div>
<pre><code>## [1] 19.57227 17.87018 18.45491 20.46718</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#selected model</span>
L2</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    25.22190     -1.43158      0.05408</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(L2<span class="op">$</span>fit, L2<span class="op">$</span>res)    <span class="co">#residuals vs fitted values</span>
<span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)            <span class="co">#reference line</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqnorm</span>(L2<span class="op">$</span>res)          <span class="co">#normal probability plot</span>
<span class="kw">qqline</span>(L2<span class="op">$</span>res)          <span class="co">#reference line</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-6-20181116" class="section level2">
<h2>Exercise 6 (20181116)</h2>
</div>
<div id="problem-8.1" class="section level2">
<h2>Problem 8.1</h2>
<p>Implement the two-sample Cramer-von Mises test for equal distributions as a permutation test. Apply the test to the data in Examples 8.1 and 8.2.</p>
</div>
<div id="answer-18" class="section level2">
<h2>Answer</h2>
<p>The Cramer-von Mises statistic, which estimates the integrated squared distance between the distributions, is defined by <span class="math display">\[W_2=\frac{mn}{(m+n)^2}\left[
    \sum_{i=1}^n(F_n(x_i)-G_m(x_i))^2+\sum_{j=1}^m(F_n(y_j)-G_m(y_j))^2\right]\]</span> By looking for wikipedia, I found another formula, <span class="math display">\[T=W_2=\frac{U}{nm(n+m)}-\frac{4mn-1}{6(n+m)}\]</span> where <span class="math display">\[U=n\sum_{i=1}^{n}(x_i-i)^2+m\sum_{j=1}^{m}(y_j-j)^2\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##function:two-sample Cramer-von Mises test for equal distributions
cvm &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){
  r &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#permutation samples</span>
  reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(r)
  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)
  m &lt;-<span class="st"> </span><span class="kw">length</span>(y)
  v.n &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
  v1.n &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
  v.m &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
  v1.m &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
  z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)
  N &lt;-<span class="st"> </span><span class="kw">length</span>(z)
  Ix &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span>n)
  Iy &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span>m)
  v.n &lt;-<span class="st"> </span>(x<span class="op">-</span>Ix)<span class="op">**</span><span class="dv">2</span>
  v.m &lt;-<span class="st"> </span>(y<span class="op">-</span>Iy)<span class="op">**</span><span class="dv">2</span>
  <span class="co">#test statistic</span>
  reps_<span class="dv">0</span> &lt;-<span class="st"> </span>((n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(v.n)<span class="op">+</span>m <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(v.m))<span class="op">/</span>(m <span class="op">*</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span>N))<span class="op">-</span>(<span class="dv">4</span> <span class="op">*</span><span class="st"> </span>m <span class="op">*</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span>(<span class="dv">6</span> <span class="op">*</span><span class="st"> </span>N)
  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>r){<span class="co">#permutation samples</span>
    w &lt;-<span class="st"> </span><span class="kw">sample</span>(N,<span class="dt">size=</span>n,<span class="dt">replace=</span><span class="ot">FALSE</span>)
    x1 &lt;-<span class="st"> </span><span class="kw">sort</span>(z[w])
    y1 &lt;-<span class="st"> </span><span class="kw">sort</span>(z[<span class="op">-</span>w])
    v1.n &lt;-<span class="st"> </span>(x1<span class="op">-</span>Ix)<span class="op">**</span><span class="dv">2</span>
    v1.m &lt;-<span class="st"> </span>(y1<span class="op">-</span>Iy)<span class="op">**</span><span class="dv">2</span>
    reps[k] &lt;-<span class="st"> </span>((n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(v1.n)<span class="op">+</span>m <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(v1.m))<span class="op">/</span>(m <span class="op">*</span><span class="st"> </span>n <span class="op">*</span><span class="st"> </span>N))<span class="op">-</span>(<span class="dv">4</span> <span class="op">*</span><span class="st"> </span>m <span class="op">*</span><span class="st"> </span>n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">/</span>(<span class="dv">6</span> <span class="op">*</span><span class="st"> </span>N)
  }
  p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(reps_<span class="dv">0</span>,reps) <span class="op">&gt;=</span><span class="st"> </span>reps_<span class="dv">0</span>)
  res &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">reps=</span>reps,<span class="dt">reps0=</span>reps_<span class="dv">0</span>,<span class="dt">pvalue=</span>p)
  <span class="kw">return</span>(res)
}

##Data: Example 8.1
<span class="kw">attach</span>(chickwts)
x &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;soybean&quot;</span>]))
y &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;linseed&quot;</span>]))

cvm1 &lt;-<span class="st"> </span><span class="kw">cvm</span>(x,y)

<span class="kw">hist</span>(cvm1<span class="op">$</span>reps, <span class="dt">main =</span> <span class="st">&quot;Example 8.1&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>, 
     <span class="dt">xlab =</span> <span class="st">&quot;Replicates of Cramer-Von Mises statistic&quot;</span>, <span class="dt">breaks =</span> <span class="st">&quot;scott&quot;</span>,
     <span class="dt">sub=</span><span class="kw">list</span>(<span class="kw">substitute</span>(<span class="kw">paste</span>(<span class="kw">hat</span>(p),<span class="st">&quot;=&quot;</span>,pvalue),<span class="kw">list</span>(<span class="dt">pvalue=</span>cvm1<span class="op">$</span>pvalue)),<span class="dt">col=</span><span class="dv">2</span>))
<span class="kw">points</span>(cvm1<span class="op">$</span>reps0, <span class="dv">0</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Data: Example 8.2
x &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;sunflower&quot;</span>]))
y &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">as.vector</span>(weight[feed <span class="op">==</span><span class="st"> &quot;linseed&quot;</span>]))
<span class="kw">detach</span>(chickwts)

cvm2 &lt;-<span class="st"> </span><span class="kw">cvm</span>(x,y)

<span class="kw">hist</span>(cvm2<span class="op">$</span>reps, <span class="dt">main =</span> <span class="st">&quot;Example 8.1&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>, 
     <span class="dt">xlab =</span> <span class="st">&quot;Replicates of Cramer-Von Mises statistic&quot;</span>, <span class="dt">breaks =</span> <span class="st">&quot;scott&quot;</span>,
     <span class="dt">sub=</span><span class="kw">list</span>(<span class="kw">substitute</span>(<span class="kw">paste</span>(<span class="kw">hat</span>(p),<span class="st">&quot;=&quot;</span>,pvalue),<span class="kw">list</span>(<span class="dt">pvalue=</span>cvm1<span class="op">$</span>pvalue)),<span class="dt">col=</span><span class="dv">2</span>))
<span class="kw">points</span>(cvm2<span class="op">$</span>reps0, <span class="dv">0</span>, <span class="dt">cex =</span> <span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="problem-2-1" class="section level2">
<h2>Problem 2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations. (1)Unequal variances and equal expectations (2)Unequal variances and unequal expectations (3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodal distribution (mixture of two normal distributions) (4)Unbalanced samples (say, 1 case versus 10 controls)</p>
</div>
<div id="answer-19" class="section level2">
<h2>Answer</h2>
<p>Since energy test and ball statistic test for equal distributions can be directly achieved by energy and Ball package. We should first write the function of the NN test. Below is the variable definition and NN function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## variable definition
m &lt;-<span class="st"> </span><span class="dv">500</span> <span class="co">#permutation samples</span>
p&lt;-<span class="dv">2</span> <span class="co"># dimension of data</span>
n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#the sample size of x and y</span>
R&lt;-<span class="dv">999</span> <span class="co">#boot parameter</span>
k&lt;-<span class="dv">3</span> <span class="co">#boot parameter</span>
n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2
N =<span class="st"> </span><span class="kw">c</span>(n1,n2)
<span class="co"># the function of NN method</span>
Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k){
  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2
  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);
  z &lt;-<span class="st"> </span>z[ix, ];
  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) 
  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]
  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]
  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>.<span class="dv">5</span>)
  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="op">+</span>.<span class="dv">5</span>)
  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)
}

eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){
  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, 
                 <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)
  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)
  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])
  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)
}
p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>) <span class="co">#p</span></code></pre></div>
<p>(1)Unequal variances and equal expectations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##(1)Unequal variances and equal expectations
<span class="kw">set.seed</span>(<span class="dv">1</span>)
sd &lt;-<span class="st"> </span><span class="fl">1.5</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p)
  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">sd=</span>sd),<span class="dt">ncol=</span>p)
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value<span class="co">#NN method</span>
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value<span class="co">#energy methods</span>
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value<span class="co"># ball method</span>
}
alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>,<span class="st">'Ball'</span>),pow)
<span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">'lightblue'</span>)<span class="op">+</span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The power of ball method is better than NN and energy methods.</p>
<p>(2)Unequal variances and unequal expectations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##(2)Unequal variances and unequal expectations
<span class="kw">set.seed</span>(<span class="dv">1</span>)
mu &lt;-<span class="st"> </span><span class="fl">0.5</span>
sd &lt;-<span class="st"> </span><span class="fl">1.5</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p)
  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean=</span>mu,<span class="dt">sd=</span>sd),<span class="dt">ncol=</span>p)
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value<span class="co">#NN method</span>
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value<span class="co">#energy methods</span>
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value<span class="co"># ball method</span>
}
alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
pow</code></pre></div>
<pre><code>## [1] 0.568 0.894 0.972</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>,<span class="st">'Ball'</span>),pow)
<span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">'lightblue'</span>)<span class="op">+</span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The power of ball method is better than NN and energy methods.</p>
<p>(3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodal distribution (mixture of two normal distributions)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Non-normal distributions: t distribution with 1 df (heavy-tailed
##distribution), bimodal distribution (mixture of two normal
##distributions)
<span class="kw">set.seed</span>(<span class="dv">1</span>)
mu &lt;-<span class="st"> </span><span class="fl">0.5</span>
sd &lt;-<span class="st"> </span><span class="dv">2</span>
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>p,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>p)
  y1 =<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p);  y2 =<span class="st"> </span><span class="kw">rnorm</span>(n2<span class="op">*</span>p,<span class="dt">mean=</span>mu,<span class="dt">sd=</span>sd)
  w =<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dv">1</span>, .<span class="dv">5</span>) <span class="co"># 50:50 random choice</span>
  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(w<span class="op">*</span>y1 <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>w)<span class="op">*</span>y2,<span class="dt">ncol=</span>p)<span class="co"># normal mixture</span>
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value<span class="co">#NN method</span>
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value<span class="co">#energy methods</span>
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value<span class="co"># ball method</span>
}
alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
pow</code></pre></div>
<pre><code>## [1] 0.352 0.796 0.778</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>,<span class="st">'Ball'</span>),pow)
<span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">'lightblue'</span>)<span class="op">+</span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The power of energy method is better than NN and ball methods.</p>
<p>(4)Unbalanced samples (say, 1 case versus 10 controls)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">##Unbalanced samples 
<span class="kw">set.seed</span>(<span class="dv">1</span>)
mu &lt;-<span class="st"> </span><span class="fl">0.5</span>
N =<span class="st"> </span><span class="kw">c</span>(n1,n2<span class="op">*</span><span class="dv">2</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){
  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p),<span class="dt">ncol=</span>p);
  y &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span><span class="dv">2</span>),<span class="kw">rnorm</span>(n2<span class="op">*</span><span class="dv">2</span>,<span class="dt">mean=</span>mu));
  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)
  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value<span class="co">#NN method</span>
  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value<span class="co">#energy methods</span>
  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">12345</span>)<span class="op">$</span>p.value<span class="co"># ball method</span>
}
alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;
pow &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)
pow</code></pre></div>
<pre><code>## [1] 0.200 0.706 0.550</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">power &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">methods =</span> <span class="kw">c</span>(<span class="st">'NN'</span>,<span class="st">'energy'</span>,<span class="st">'Ball'</span>),pow)
<span class="kw">ggplot</span>(power,<span class="kw">aes</span>(methods,pow))<span class="op">+</span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">'lightblue'</span>)<span class="op">+</span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The power of energy method is better than NN and ball methods.</p>
</div>
<div id="problem-9.3" class="section level2">
<h2>Problem 9.3</h2>
<p>Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchy or qt with df=1). Recall that a Cauchy <span class="math inline">\((\theta,\eta)\)</span> distribution has density function <span class="math display">\[f(x)=\frac{1}{\theta \pi (1+[(x-\eta)/\theta]^2)},\ \  -\infty &lt; x &lt;\infty,\theta&gt;0\]</span> The standard Cauchy has the Cauchy(<span class="math inline">\(\theta=1,\eta=0\)</span>) density. (Note that the standard Cauchy density is equal to the Student t density with one degree of freedom.)</p>
</div>
<div id="answer-20" class="section level2">
<h2>Answer</h2>
<p>For the proposal distribution, try the Student t distribution with one degree of freedom. Implementation of a Metropolis-Hastings sampler for this exercise is as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
n &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#Sample size</span>
x &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)
u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)
theta=<span class="dv">1</span>
eta=<span class="dv">0</span>

x[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)
k &lt;-<span class="st"> </span><span class="dv">0</span>

<span class="co"># cauchy functions</span>
f &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">theta=</span><span class="dv">1</span>, <span class="dt">eta=</span><span class="dv">0</span>){
  out &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(pi <span class="op">*</span><span class="st"> </span>theta <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">+</span>((x<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>))
  <span class="kw">return</span>(out)
}

<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n){
  xt &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean=</span>xt)
  R &lt;-<span class="st"> </span><span class="kw">f</span>(y)<span class="op">*</span><span class="kw">dnorm</span>(xt,<span class="dt">mean=</span>y)<span class="op">/</span>(<span class="kw">f</span>(xt)<span class="op">*</span><span class="kw">dnorm</span>(y,<span class="dt">mean=</span>xt))
  <span class="cf">if</span>(u[i] <span class="op">&lt;=</span><span class="st"> </span>R){
    x[i] &lt;-<span class="st"> </span>y
  }<span class="cf">else</span>{
    x[i] &lt;-<span class="st"> </span>xt
    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span>
  }
}

is &lt;-<span class="st"> </span><span class="dv">101</span><span class="op">:</span>n

<span class="kw">plot</span>(is,x[is],<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAUVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmOpBmtttmtv+QOgCQOmaQ2/+2ZgC2/7a2///bkDrb2//b////tmb/25D//7b//9v////y5wTnAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIYklEQVR4nO3d4WKkJhQF4LubpN20TTvNNCbh/R+0KoKgwkGBUWfO+bHrJniFL4rOrGNEMdHI3h04eggEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCKQwkJwmewGVLVcvBAIhEMijApUfN4FKNdylXL3tPyxQageqAH29/mr/bNqLiJ/vBcrVyAGArk8f3dJf+eVqZH+ggaZnyixXI/sDfb70QI1/kK2/gq+U/YG4B0Xy9drtI8/KTNeZ5WokeSeudZpvjX78057IAj4EunG51ZsnENg8gcDmo0ASWI6XzOlP9XKrN/+YQCveH40BCYG6lg8ItO4d9kDj8Tvun2klS+aoQEIgs/nl1gSym48BydBGnQ8ott6KNwkIBNYUFZiETgW0OIBo+/CZabLHOALzCrqlHB5o+SccrZkEJOGd44RA03ZZQHbIMm5gocLdAy2MW50YKDix9v1MBdKYhYDUfQKJCzQ7ZzlA8uBA80NzYDOnb0dqvslzAQmBwq8PZAOQCgJJIpA6PZDYHWJaDwLZKcq5IppVl/FcttwGjqhMtgNJCpBftF9nNVCgDRxRmdjNey98+iXzLQ00hXCOgslrhziQ3CfQbP/SQBIBErFFx0Lm4m8c/+KYDg1kNmCmEA/ImV+H6TYGJHcEJAtA3p6QBCQekNoOpA4NNFqIB2R3CXGBZCXQ2C4JKNgmPiJ934ZN8A677zfQwJtoDIv50iKQTIEkAKTWAPnjH4FkM5B7S10TGv/V3NURvL3DAVJ25xiXDMUcyOGxCmJ/5iEge20g3tG8BCQ3APp+syzgBirTdxlHMQMaNab7TyqQcoDcS6tlINMdr6M4a+YghxHcghcDGsfkAKkIkLLzqzc8s1uoWwF1d41dRQK7RpfkPciO099L4kDOv00xF0iNE5rsA3R5+vh8eVaX53Djqwy7EJiD0oHM3OBMEgWAxB+/Wdc9RtcDdcdP0wIEZ2jdSA8yuJv5QGYSWQGkPCCfxHxPJA6kxouLCdD41W1AlxbnGgNKLLcENDmH21PKOEep8aytTBn3PG434ALZYtWB2mPr6/Xp4+s1coillnOAlAVSEEgVBJLyQP0NrN9vWT4+kBnHcGhMzkPmDC5mHZUDpAQB+cPdAFQk/tgQkGmp/7arLwBJHEgmQP5sPLHyF1JHVChjtzCQaSrjqiEgVQpo1tHkERVKAMhwuP1GQGKPQrUEJCoMpIoDtReJ9vVqgbOYOyt4QCoCNK6eDOTWqAtULP44xiVJA3KLmEl8tp6Mo3YVKu9BSa/mU8uVAlKPB6RKAckMyC9RHEjc5APpTtqvLACJmi35RVKAnDWmVQ4+B/XL4ixuBpp9by+g7/9SV0kqp2oByV5A5kXY998lTvOTf8hMAQJJFEhmQMs9kXJAquk+S6iuZa6DJv/YCrSwgUWgYE9KAg3/ZRH6sOXqcqlA874Or1sPB9QLBR4YsKWc++UY0ELrxVVMpch3Zz0pCnQR+fMt9p70unLel1cDja9OZpV2AmovhfSTOcrNQc6XVwJN3wHzvrcCyLxzl9zRSMOvP/SuU/As5nx5eZ4JFYkBRQ/AaU+GNzbTO5rRMKscHM6kdQEg8xrnJEDrikSBzL6R0pX7BopuIwlITgO0skgcaGiT0JW7BoJtErpya6BbPaIrBSipwS5AN3hE16mBbvGApYJA6uZAy4/o2lQu3KdiQPrve9yDcJ1jAnVdr/+IriQgXOX2QCr4iK7x/f515YK9Oi3QjcqVARLv7+l3k8usjnOrYolyi2UIBEIgkBJAw24YeOu2Yk8IBEKgjBDoRuUIVL8OgVAJA5S3AQLV70mNcgSqX4dAsAaBQI1YEQIRCNcgEKhBIFCDQKDGPQOVCIFACARCIBACgRAIJNoXAoEQCIRAIAQC2Q3oNNkJKGMzuEmRImtHTKCyzbeGQPmbIVB2EwLdogiBCjTJaL41BMrfzGMDnTcEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEUg+of6he/8myRvonEDoL6fl80R9Ezyny+fv7coWUUtWAvt/abV+7wTXdB8m7jtiF9DRPH/oRmBlFvl77x0TMKySVqgakn2Fx/fmuP6B4eVZ2IT16lbwijX5YzbxCWqnKc1D7A7JSdiF99c/fhp/v9iKN/OofNDKvkFaqMtCl7Uc/yMZZSF+9+fnvaz+R5RTRrecV0krVBeqeYaGP8vZPu5C+fv9k2e53feQU0QbzCmmlqgI1Zo7eDPRj+CHfJ5B+BkrO0aEniHayuMtDbPiFfzmTtO59O5KcIuqgk7T5ZWQ5p3n9OKcm71pBAx3uNP/5Yp7PkHOh2D3pqh9I1tXmIS8Ur/pGLv2U8+GK/rr+pUZjXq9kFBmmmXmFlFJ8sQpCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRwbKPib8G6XYwMdIAQCOTZQf4h1N9vn/pr37Tk+UH+nXLOb0PGB1t2wWTzHBxo+arFXjg+kPzbEOWgx9jrosvbexmI5CdB+V4zHB7J37O6T4wP1dwLv5nNwoAOEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKB/A9psIZ5DqnFSwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(x[is], <span class="dt">probability=</span><span class="ot">TRUE</span>,<span class="dt">breaks=</span><span class="dv">100</span>)
plot.x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">min</span>(x[is]),<span class="kw">max</span>(x[is]),<span class="fl">0.01</span>)
<span class="kw">lines</span>(plot.x,<span class="kw">f</span>(plot.x))</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#compare the deciles</span>
observations &lt;-<span class="st"> </span><span class="kw">quantile</span>(x[is],<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))
expectations &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>))
decile &lt;-<span class="st"> </span><span class="kw">data.frame</span>(observations,expectations)
decile</code></pre></div>
<pre><code>##      observations expectations
## 0%     -8.8927769         -Inf
## 10%    -3.2422433   -3.0776835
## 20%    -1.8883217   -1.3763819
## 30%    -1.0868193   -0.7265425
## 40%    -0.5831603   -0.3249197
## 50%    -0.1373446    0.0000000
## 60%     0.2788956    0.3249197
## 70%     0.6170561    0.7265425
## 80%     1.2151632    1.3763819
## 90%     2.2273095    3.0776835
## 100%    5.9987643          Inf</code></pre>
<p>We can see, the middle quantile is very close. The following QQ and histograms also verify this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qqnorm</span>(x[is])
<span class="kw">qqline</span>(x[is])</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sequence &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)
standardCauchy &lt;-<span class="st"> </span><span class="kw">qcauchy</span>(sequence)
standardCauchy &lt;-<span class="st"> </span>standardCauchy[(standardCauchy<span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="ot">Inf</span>) 
                                 <span class="op">&amp;</span><span class="st"> </span>(standardCauchy<span class="op">&lt;</span><span class="st"> </span><span class="ot">Inf</span>)]
<span class="kw">hist</span>(x[is], <span class="dt">freq =</span> <span class="ot">FALSE</span>,<span class="dt">main =</span> <span class="st">&quot;&quot;</span>)
<span class="kw">lines</span>(standardCauchy, <span class="kw">dcauchy</span>(standardCauchy), <span class="dt">lty =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="problem-9.6" class="section level2">
<h2>Problem 9.6</h2>
<p>Rao presented an example on genetic linkage of 197 animals in four categories (also discussed in [67, 106, 171, 266]). The group sizes are (125, 18, 20, 34). Assume that the probabilities of the corresponding multinomial distribution are <span class="math display">\[(\frac{1}{2}+\frac{\theta}{4},\frac{1-\theta}{4},\frac{1-\theta}{4},\frac{\theta}{4})\]</span> Estimate the posterior distribution of <span class="math inline">\(\theta\)</span> given the observed sample, using one of the methods in this chapter.</p>
</div>
<div id="answer-21" class="section level2">
<h2>Answer</h2>
<p>Estimate the posterior distribution of <span class="math inline">\(\theta\)</span> given the observed sample is as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">10000</span>
burn.in &lt;-<span class="st"> </span><span class="dv">2000</span>
sizes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
size &lt;-<span class="st"> </span><span class="kw">sum</span>(sizes)

prob &lt;-<span class="st"> </span><span class="cf">function</span>(theta){
  p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span><span class="op">+</span>theta<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>,theta<span class="op">/</span><span class="dv">4</span>)
}

prob.ratio &lt;-<span class="st"> </span><span class="cf">function</span>(n,d){
  <span class="kw">prod</span>(<span class="kw">prob</span>(n)<span class="op">^</span>sizes<span class="op">/</span><span class="kw">prob</span>(d)<span class="op">^</span>sizes)
}</code></pre></div>
<p>I tried three different ways to produce samples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># random walk </span>
<span class="co"># using unif(-0.25,0.25) as step</span>

x.rw &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
k.rw &lt;-<span class="st"> </span><span class="dv">0</span>
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)
v &lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.25</span>)
x.rw[<span class="dv">1</span>] &lt;-<span class="st"> </span>v[<span class="dv">1</span>]
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m){
  xt &lt;-<span class="st"> </span>x.rw[i<span class="op">-</span><span class="dv">1</span>]
  y &lt;-<span class="st"> </span>xt <span class="op">+</span><span class="st"> </span>v[i]
  r &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">prob.ratio</span>(y,xt),<span class="dv">1</span>)
  <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.nan</span>(r) <span class="op">&amp;&amp;</span><span class="st"> </span>u[i] <span class="op">&lt;=</span><span class="st"> </span>r){
    x.rw[i] &lt;-<span class="st"> </span>y
  }<span class="cf">else</span>{
    k.rw &lt;-<span class="st"> </span>k.rw <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    x.rw[i] &lt;-<span class="st"> </span>xt
  }
}
<span class="kw">print</span>(k.rw)</code></pre></div>
<pre><code>## [1] 6733</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># MH samplings</span>
sd &lt;-<span class="st"> </span><span class="fl">0.5</span>
min &lt;-<span class="st"> </span><span class="op">-</span><span class="fl">0.8</span>
max &lt;-<span class="st"> </span><span class="fl">0.8</span>

rg &lt;-<span class="st"> </span><span class="cf">function</span>(p){
  <span class="kw">return</span>(<span class="kw">runif</span>(<span class="dv">1</span>,min<span class="op">-</span><span class="kw">abs</span>(p),max<span class="op">+</span><span class="kw">abs</span>(p)))
}

dg &lt;-<span class="st"> </span><span class="cf">function</span>(x,p){
  <span class="kw">return</span>(<span class="kw">dunif</span>(x,min<span class="op">-</span><span class="kw">abs</span>(p),max<span class="op">+</span><span class="kw">abs</span>(p)))
}

x.mh &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
k.mh &lt;-<span class="st"> </span><span class="dv">0</span>
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)
x.mh[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rg</span>(<span class="dv">0</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m){
  xt &lt;-<span class="st"> </span>x.mh[i<span class="op">-</span><span class="dv">1</span>]
  y &lt;-<span class="st"> </span><span class="kw">rg</span>(xt)
  r &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">prob.ratio</span>(y,xt)<span class="op">*</span><span class="kw">dg</span>(xt,y)<span class="op">/</span><span class="kw">dg</span>(y,xt),<span class="dv">1</span>)
  <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.na</span>(r) <span class="op">&amp;&amp;</span><span class="st"> </span>u[i] <span class="op">&lt;=</span><span class="st"> </span>r){
    x.mh[i] &lt;-<span class="st"> </span>y
  }<span class="cf">else</span>{
    x.mh[i] &lt;-<span class="st"> </span>xt
    k.mh &lt;-<span class="st"> </span>k.mh <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  }
}
<span class="kw">print</span>(k.mh)</code></pre></div>
<pre><code>## [1] 9810</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># independence sampler</span>
x.i &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)
k.i &lt;-<span class="st"> </span><span class="dv">0</span>
x.i[i] &lt;-<span class="st"> </span><span class="kw">rg</span>(<span class="dv">0</span>)
u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m){
  xt &lt;-<span class="st"> </span>x.i[i<span class="op">-</span><span class="dv">1</span>]
  y &lt;-<span class="st"> </span><span class="kw">rg</span>(<span class="dv">0</span>)
  r &lt;-<span class="st"> </span><span class="kw">prob.ratio</span>(y,xt)<span class="op">*</span><span class="kw">dg</span>(xt,<span class="dv">0</span>)<span class="op">/</span><span class="kw">dg</span>(y,<span class="dv">0</span>)
  <span class="cf">if</span>(u[i] <span class="op">&lt;=</span><span class="st"> </span>r){
    x.i[i] &lt;-<span class="st"> </span>y
  }<span class="cf">else</span>{
    x.i[i] &lt;-<span class="st"> </span>xt
    k.i &lt;-<span class="st"> </span>k.i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  }
}
<span class="kw">print</span>(k.i)</code></pre></div>
<pre><code>## [1] 8973</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#histogram</span>
is &lt;-<span class="st"> </span>(burn.in <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>m
xs &lt;-<span class="st"> </span><span class="kw">as.list</span>(x.rw,x.mh)

x &lt;-<span class="st"> </span>x.rw[is]
<span class="kw">hist</span>(x,<span class="dt">probability=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(is,x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>x.mh[is]
<span class="kw">hist</span>(x,<span class="dt">probability=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(is,x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>x.i[is]
<span class="kw">hist</span>(x,<span class="dt">probability=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(is,x,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu.rw &lt;-<span class="st"> </span><span class="kw">mean</span>(x.rw[is])
mu.mh &lt;-<span class="st"> </span><span class="kw">mean</span>(x.mh[is])
mu.i &lt;-<span class="st"> </span><span class="kw">mean</span>(x.i[is])
<span class="kw">print</span>(<span class="kw">c</span>(mu.rw,mu.mh,mu.i))</code></pre></div>
<pre><code>## [1]  0.6222162 43.8515593  0.6263975</code></pre>
<p>We can see, the estimate of MH sampling with uniform prior distribution has big error while the random walk and independent prior distribution is good.</p>
</div>
<div id="exercise-7-20181123" class="section level2">
<h2>Exercise 7 (20181123)</h2>
</div>
<div id="problem-9.6continue" class="section level2">
<h2>Problem 9.6(continue)</h2>
<p>For exercise 9.6, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until the chain has converged approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-22" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {
  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span>
  <span class="co"># for chain in i-th row of X</span>
  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)
  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)
  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)
  psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span>
  B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span>
  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span>
  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span>
  v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span>
  r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span>
  <span class="kw">return</span>(r.hat)
}

prob &lt;-<span class="st"> </span><span class="cf">function</span>(theta){
  p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span><span class="op">+</span>theta<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>,(<span class="dv">1</span><span class="op">-</span>theta)<span class="op">/</span><span class="dv">4</span>,theta<span class="op">/</span><span class="dv">4</span>)
}

prob.ratio &lt;-<span class="st"> </span><span class="cf">function</span>(n,d){
  <span class="kw">prod</span>(<span class="kw">prob</span>(n)<span class="op">^</span>sizes<span class="op">/</span><span class="kw">prob</span>(d)<span class="op">^</span>sizes)
}

sample.chain &lt;-<span class="st"> </span><span class="cf">function</span>(N, X1){
  <span class="co">#generates a Metropolis chain for multinomial distribution </span>
  <span class="co">#in exercise 9.6 with random walk proposal distribution</span>
  <span class="co">#and starting value X1</span>
  x &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)
  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>X1
  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)
  v &lt;-<span class="st"> </span><span class="kw">runif</span>(N,<span class="op">-</span><span class="fl">0.25</span>,<span class="fl">0.25</span>)
  
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){
    xt &lt;-<span class="st"> </span>x[i<span class="op">-</span><span class="dv">1</span>]
    y &lt;-<span class="st"> </span>xt <span class="op">+</span><span class="st"> </span>v[i] <span class="co">#candidate point</span>
    r &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">prob.ratio</span>(y,xt),<span class="dv">1</span>)
    <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.nan</span>(r) <span class="op">&amp;&amp;</span><span class="st"> </span>u[i] <span class="op">&lt;=</span><span class="st"> </span>r){
      x[i] &lt;-<span class="st"> </span>y
    }<span class="cf">else</span>{
      x[i] &lt;-<span class="st"> </span>xt
    }
  }
  <span class="kw">return</span>(x)
}</code></pre></div>
<p>The simulation is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
k &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#number of chains to generate</span>
n &lt;-<span class="st"> </span><span class="dv">15000</span> <span class="co">#length of chains</span>
b &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co">#burn-in length</span>
sizes &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">125</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">34</span>)
size &lt;-<span class="st"> </span><span class="kw">sum</span>(sizes)
<span class="co">#choose overdispersed initial values</span>
x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>)
<span class="co">#generate the chains</span>
X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span>k, <span class="dt">ncol=</span>n)
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){
  X[i, ] &lt;-<span class="st"> </span><span class="kw">sample.chain</span>(n, x0[i])
}
  
<span class="co">#compute diagnostic statistics</span>
psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))
  psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))
<span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</code></pre></div>
<pre><code>## [1] 1.026943</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot psi for the four chains</span>

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){
  <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))
}</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot the sequence of R-hat statistics</span>
rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)
<span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){
  rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])
}
<span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It seems that the chain converge since N=1800.</p>
</div>
<div id="problem-11.4" class="section level2">
<h2>Problem 11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt(k))\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}}\right)\]</span> and <span class="math display">\[S_k(a)=P\left(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}}\right)\]</span> for <span class="math inline">\(k = 4 : 25, 100, 500, 1000\)</span>, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Szekely [260].)</p>
</div>
<div id="answer-23" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">findIntersection &lt;-<span class="st"> </span><span class="cf">function</span> (k) {
  ##The function to find the intersection points
  s_k.minus.one &lt;-<span class="st"> </span><span class="cf">function</span> (a) {
    <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="op">-</span><span class="dv">1</span>)<span class="op">/</span>(k <span class="op">-</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df=</span>k<span class="op">-</span><span class="dv">1</span>)
  }
  
  s_k &lt;-<span class="st"> </span><span class="cf">function</span> (a) {
    <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df =</span> k)
  }
  
  f &lt;-<span class="st"> </span><span class="cf">function</span> (a) {
    <span class="kw">s_k</span>(a) <span class="op">-</span><span class="st"> </span><span class="kw">s_k.minus.one</span>(a)
  }
  
  eps =<span class="st"> </span><span class="fl">1e-2</span>
  <span class="kw">return</span>(<span class="kw">uniroot</span>(f, <span class="dt">interval =</span> <span class="kw">c</span>(eps, <span class="kw">sqrt</span>(k)<span class="op">-</span>eps))<span class="op">$</span>root)
}

rs =<span class="st"> </span><span class="kw">sapply</span>(<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span> (k) {
  <span class="kw">findIntersection</span>(k)
})
result &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">k=</span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>),<span class="dt">intersection=</span>rs)
<span class="kw">print</span>(result)</code></pre></div>
<pre><code>##       k intersection
## 1     4     1.492073
## 2     5     1.533555
## 3     6     1.562745
## 4     7     1.584429
## 5     8     1.601184
## 6     9     1.614516
## 7    10     1.625389
## 8    11     1.634418
## 9    12     1.642026
## 10   13     1.648552
## 11   14     1.654175
## 12   15     1.659099
## 13   16     1.663454
## 14   17     1.667287
## 15   18     1.670733
## 16   19     1.673832
## 17   20     1.676605
## 18   21     1.679148
## 19   22     1.681468
## 20   23     4.785832
## 21   24     4.888979
## 22   25     4.990000
## 23  100     9.990000
## 24  500    22.350680
## 25 1000    31.612777</code></pre>
</div>
<div id="exercise-8-20181130" class="section level2">
<h2>Exercise 8 (20181130)</h2>
</div>
<div id="problem-11.6" class="section level2">
<h2>Problem 11.6</h2>
<p>Write a function to compute the cdf of the Cauchy distribution, which has density <span class="math display">\[\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},\ \ -\infty&lt;x&lt;\infty\]</span> where <span class="math inline">\(\theta&gt;0\)</span>. Compare your results to the results from the R function .(Also see the source code in .)</p>
</div>
<div id="answer-24" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.dcauchy &lt;-<span class="st"> </span><span class="cf">function</span>(x,eta,theta){
  <span class="kw">stopifnot</span>(theta <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
  <span class="kw">return</span>(<span class="dv">1</span><span class="op">/</span>(theta<span class="op">*</span>pi<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>((x<span class="op">-</span>eta)<span class="op">/</span>theta)<span class="op">^</span><span class="dv">2</span>)))
}

my.pcauchy &lt;-<span class="st"> </span><span class="cf">function</span>(x,eta,theta) {
  <span class="kw">stopifnot</span>(theta <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)
  
  integral &lt;-<span class="st"> </span><span class="cf">function</span> (x) {
    <span class="kw">my.dcauchy</span>(x,eta,theta)
  }
  
  <span class="kw">return</span>(<span class="kw">integrate</span>(integral, <span class="dt">lower =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">upper =</span> x)<span class="op">$</span>value)
}

eta &lt;-<span class="st"> </span><span class="dv">0</span>
theta &lt;-<span class="st"> </span><span class="dv">2</span>
xs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>)
estimate &lt;-<span class="st"> </span><span class="kw">sapply</span>(xs, <span class="cf">function</span>(x) <span class="kw">my.pcauchy</span>(x, eta,theta))
truth &lt;-<span class="st"> </span><span class="kw">sapply</span>(xs, <span class="cf">function</span>(x) <span class="kw">pcauchy</span>(x, eta, theta))
<span class="kw">round</span>(<span class="kw">rbind</span>(estimate, truth), <span class="dv">4</span>)</code></pre></div>
<pre><code>##            [,1]   [,2]  [,3]   [,4]   [,5]   [,6]   [,7]   [,8] [,9]
## estimate 0.0628 0.0696 0.078 0.0886 0.1024 0.1211 0.1476 0.1872 0.25
## truth    0.0628 0.0696 0.078 0.0886 0.1024 0.1211 0.1476 0.1872 0.25
##           [,10] [,11]  [,12] [,13]  [,14]  [,15]  [,16]  [,17]  [,18]
## estimate 0.3524   0.5 0.6476  0.75 0.8128 0.8524 0.8789 0.8976 0.9114
## truth    0.3524   0.5 0.6476  0.75 0.8128 0.8524 0.8789 0.8976 0.9114
##          [,19]  [,20]  [,21]
## estimate 0.922 0.9304 0.9372
## truth    0.922 0.9304 0.9372</code></pre>
</div>
<div id="problem-2a-b-o-blood-type-problem" class="section level2">
<h2>Problem 2(A-B-O blood type problem)</h2>
Let the three alleles be A, B and O.
<span class="math display">\[\begin{array}{c|cccccc} 
\hline 
Genotype &amp; \text{AA} &amp; \text{BB} &amp; \text{OO} &amp; \text{AO} &amp; \text{BO} &amp; \text{AB} &amp; \text{AA}\\ 
\hline 
Frequency &amp; \text{p2} &amp; \text{q2} &amp; \text{r2} &amp; \text{2pr} &amp; \text{2qr} &amp; \text{2pq} &amp; \text{1}\\ 
\hline 
Count &amp; \text{nAA} &amp; \text{nBB} &amp; \text{nOO} &amp; \text{nAO} &amp; \text{nBO} &amp; \text{nAB} &amp; \text{n}\\
\hline 
\end{array}\]</span>
<ol style="list-style-type: decimal">
<li>Observed data: <span class="math inline">\(n_{A??} = n_{AA} + n_{AO} = 28 (A-type)\)</span>, <span class="math inline">\(n_{B??} = n_{BB} + n_{BO} = 24 (B-type)\)</span>, <span class="math inline">\(n_{OO} = 41 (O-type), n_{AB} = 70(AB-type)\)</span>.</li>
<li>Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</li>
<li>Record the maximum likelihood values in M-steps, are they increasing?</li>
</ol>
</div>
<div id="answer-25" class="section level2">
<h2>Answer</h2>
<ol style="list-style-type: decimal">
<li>The EM algorithm is as follows:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">counts &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">28</span>,<span class="dv">24</span>,<span class="dv">41</span>,<span class="dv">70</span>)<span class="co">#nA,nB,nO,nAB</span>
theta.init &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.6</span>)<span class="co">#intial value:p,q,r</span>

sample.size =<span class="st"> </span><span class="kw">sum</span>(counts)

n.A =<span class="st"> </span>counts[<span class="dv">1</span>]
n.B =<span class="st"> </span>counts[<span class="dv">2</span>]
n.O =<span class="st"> </span>counts[<span class="dv">3</span>]
n.AB =<span class="st"> </span>counts[<span class="dv">4</span>]

##EM algorithm
theta.cur =<span class="st"> </span>theta.init
theta.next =<span class="st"> </span>theta.cur
log.L &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&quot;numeric&quot;</span>,<span class="dt">length=</span><span class="dv">0</span>)

discrepancy =<span class="st"> </span><span class="fl">1.0</span>
i &lt;-<span class="st"> </span><span class="dv">1</span>

<span class="cf">while</span>(discrepancy<span class="op">&gt;</span><span class="dv">10</span><span class="op">^-</span><span class="dv">7</span>){
  theta.cur =<span class="st"> </span>theta.next
  
  ## E step
  n.aa =<span class="st"> </span>n.A<span class="op">*</span>theta.cur[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(theta.cur[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>theta.cur[<span class="dv">1</span>]<span class="op">*</span>theta.cur[<span class="dv">3</span>])
  n.ao =<span class="st"> </span>n.A<span class="op">*</span><span class="dv">2</span><span class="op">*</span>theta.cur[<span class="dv">1</span>]<span class="op">*</span>theta.cur[<span class="dv">3</span>]<span class="op">/</span>(theta.cur[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>theta.cur[<span class="dv">1</span>]<span class="op">*</span>theta.cur[<span class="dv">3</span>])
  n.bb =<span class="st"> </span>n.B<span class="op">*</span>theta.cur[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(theta.cur[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>theta.cur[<span class="dv">2</span>]<span class="op">*</span>theta.cur[<span class="dv">3</span>])
  n.bo =<span class="st"> </span>n.B<span class="op">*</span><span class="dv">2</span><span class="op">*</span>theta.cur[<span class="dv">2</span>]<span class="op">*</span>theta.cur[<span class="dv">3</span>]<span class="op">/</span>(theta.cur[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>theta.cur[<span class="dv">2</span>]<span class="op">*</span>theta.cur[<span class="dv">3</span>])
  n.oo =<span class="st"> </span>n.O
  n.ab =<span class="st"> </span>n.AB
  
  ## M step
  theta.next[<span class="dv">1</span>] =<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>n.aa<span class="op">+</span>n.ab<span class="op">+</span>n.ao)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sample.size)
  theta.next[<span class="dv">2</span>] =<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>n.bb<span class="op">+</span>n.ab<span class="op">+</span>n.bo)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sample.size)
  theta.next[<span class="dv">3</span>] =<span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>n.oo<span class="op">+</span>n.ao<span class="op">+</span>n.bo)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sample.size)
  logL  &lt;-<span class="st"> </span>n.A<span class="op">*</span><span class="kw">log</span>((theta.next[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>theta.next[<span class="dv">1</span>]<span class="op">*</span>theta.next[<span class="dv">3</span>]))<span class="op">+</span>
<span class="st">    </span>n.B<span class="op">*</span><span class="kw">log</span>((theta.next[<span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>theta.next[<span class="dv">1</span>]<span class="op">*</span>theta.next[<span class="dv">3</span>]))<span class="op">+</span>
<span class="st">    </span>n.O<span class="op">*</span><span class="kw">log</span>((theta.next[<span class="dv">3</span>]<span class="op">^</span><span class="dv">2</span>))<span class="op">+</span>
<span class="st">    </span>n.AB<span class="op">*</span><span class="kw">log</span>((theta.next[<span class="dv">2</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>theta.next[<span class="dv">2</span>]<span class="op">*</span>theta.next[<span class="dv">3</span>]))
  log.L[i] &lt;-<span class="st"> </span>logL
  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span>
  <span class="kw">print</span>(<span class="kw">c</span>(theta.next,logL))
  
  discrepancy =<span class="st"> </span><span class="kw">max</span>(<span class="kw">abs</span>(theta.next <span class="op">-</span><span class="st"> </span>theta.cur))
}</code></pre></div>
<pre><code>## [1]    0.3128834    0.2988606    0.3882559 -213.0048770
## [1]    0.3252817    0.3088035    0.3659148 -217.4157752
## [1]    0.3270424    0.3101899    0.3627677 -218.0842039
## [1]    0.3272999    0.3103919    0.3623081 -218.1828162
## [1]    0.3273377    0.3104216    0.3622407 -218.1973131
## [1]    0.3273433    0.3104259    0.3622308 -218.1994432
## [1]    0.3273441    0.3104266    0.3622293 -218.1997561
## [1]    0.3273442    0.3104267    0.3622291 -218.1998021
## [1]    0.3273442    0.3104267    0.3622291 -218.1998088</code></pre>
<p>The value of p and q solved by our EM algorithm are <span class="math inline">\(p=0.3273442\)</span> and <span class="math inline">\(q=0.3104267\)</span>.</p>
<p>(2)Its obvious that the maximum likelihood values in M-steps is decreasing.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(log.L,<span class="dt">type=</span><span class="st">&quot;b&quot;</span>,<span class="dt">lty=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-9-20181207" class="section level2">
<h2>Exercise 9 (20181207)</h2>
</div>
<div id="problem-1exercise-3-p204-advanced-r" class="section level2">
<h2>Problem 1(Exercise 3, p204, Advanced R)</h2>
<p>Use both for loops and  to fit linear models to the  using the formulas stored in this list:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(
  mpg <span class="op">~</span><span class="st"> </span>disp,
  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),
  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,
  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt
)</code></pre></div>
</div>
<div id="answer-26" class="section level2">
<h2>Answer</h2>
<p>(1)Using loops:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># for loop</span>
lf1 &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){
  lf1[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)
}
lf1</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>(2)Using :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># lapply (2 versions)</span>
la1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, lm, <span class="dt">data =</span> mtcars)
la2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(<span class="dt">formula =</span> x, <span class="dt">data =</span> mtcars))
la1</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">la2 </code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = x, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<p>Obviously, two results are same.</p>
</div>
<div id="problem-2exercise-4-p204-advanced-r" class="section level2">
<h2>Problem 2(Exercise 4, p204, Advanced R)</h2>
<p>Fit the model  to each of the bootstrap replicates of  in the list below by using a for loop and . Can you do it without an anonymous function?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i){
  rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)
  mtcars[rows, ]
})<span class="co">#eturns a list of the same length as mtcars</span></code></pre></div>
</div>
<div id="answer-27" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## for loop
lf &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(bootstraps))
<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){
  lf[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, <span class="dt">data =</span> bootstraps[[i]])
}
lf</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.03393     -0.04712  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.74721     -0.05465  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.54409     -0.04672  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.34256     -0.03967  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.77241     -0.05038  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.19588     -0.04482  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.59086     -0.04976  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.45385     -0.03192  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.07670     -0.04553  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.37863     -0.03694</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># lapply without anonymous function</span>
la &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp)
la</code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.03393     -0.04712  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.74721     -0.05465  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.54409     -0.04672  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.34256     -0.03967  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.77241     -0.05038  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.19588     -0.04482  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.59086     -0.04976  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    26.45385     -0.03192  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.07670     -0.04553  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.37863     -0.03694</code></pre>
</div>
<div id="problem-3exercise-5-p204-advanced-r" class="section level2">
<h2>Problem 3(Exercise 5, p204, Advanced R)</h2>
<p>For each model in the previous two exercises, extract <span class="math inline">\(\mathbf{R^2}\)</span> using the function below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</code></pre></div>
</div>
<div id="answer-28" class="section level2">
<h2>Answer</h2>
<p>For the models in exercise 1:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(la1, rsq)</code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(la2, rsq)</code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(lf1, rsq)</code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<p>For the models in exercise 2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(la, rsq)</code></pre></div>
<pre><code>##  [1] 0.6561281 0.7824734 0.7599183 0.7114511 0.6310431 0.7805282 0.8347510
##  [8] 0.6274358 0.7247127 0.7948518</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(lf, rsq)</code></pre></div>
<pre><code>##  [1] 0.6561281 0.7824734 0.7599183 0.7114511 0.6310431 0.7805282 0.8347510
##  [8] 0.6274358 0.7247127 0.7948518</code></pre>
</div>
<div id="problem-4exercise-3-p214-advanced-r" class="section level2">
<h2>Problem 4(Exercise 3, p214, Advanced R)</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use  and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>,<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),
                    <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-29" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># anonymous function:</span>
<span class="kw">sapply</span>(trials, <span class="cf">function</span>(test) test<span class="op">$</span>p.value)</code></pre></div>
<pre><code>##   [1] 0.226234733 0.878699690 0.023636944 0.002863181 0.283263429
##   [6] 0.342715493 0.280393022 0.895401464 0.444668045 0.955958794
##  [11] 0.840814492 0.915422519 0.318264061 0.659470388 0.755335363
##  [16] 0.062552306 0.201374001 0.843761138 0.102700821 0.810551787
##  [21] 0.336871352 0.983426627 0.654647238 0.212360540 0.558590192
##  [26] 0.515757542 0.627910997 0.354903758 0.932726022 0.410597054
##  [31] 0.588269425 0.766716658 0.305949455 0.191648159 0.923430953
##  [36] 0.233832635 0.007715163 0.636923221 0.546470935 0.101839183
##  [41] 0.633595727 0.885810579 0.641792946 0.260437129 0.377980255
##  [46] 0.329324914 0.909868603 0.904938123 0.895475321 0.796516410
##  [51] 0.886190335 0.241623031 0.457651060 0.508391008 0.554745562
##  [56] 0.555530013 0.517136450 0.237152954 0.726398646 0.128271193
##  [61] 0.055546426 0.833201948 0.055684921 0.313481890 0.674045813
##  [66] 0.496379419 0.181788795 0.588977335 0.272538493 0.428096391
##  [71] 0.690500493 0.147715047 0.120305341 0.465157841 0.805365236
##  [76] 0.548290932 0.279067560 0.920286134 0.298992191 0.283991735
##  [81] 0.441317646 0.533652819 0.142944393 0.920812613 0.634335308
##  [86] 0.719262180 0.343715387 0.506414946 0.647267652 0.161587341
##  [91] 0.558221586 0.571337643 0.948372532 0.481177694 0.846617931
##  [96] 0.537704063 0.642115127 0.139222858 0.436743209 0.462786126</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(trials, <span class="st">'[['</span>, <span class="dt">i =</span> <span class="st">&quot;p.value&quot;</span>) </code></pre></div>
<pre><code>##   [1] 0.226234733 0.878699690 0.023636944 0.002863181 0.283263429
##   [6] 0.342715493 0.280393022 0.895401464 0.444668045 0.955958794
##  [11] 0.840814492 0.915422519 0.318264061 0.659470388 0.755335363
##  [16] 0.062552306 0.201374001 0.843761138 0.102700821 0.810551787
##  [21] 0.336871352 0.983426627 0.654647238 0.212360540 0.558590192
##  [26] 0.515757542 0.627910997 0.354903758 0.932726022 0.410597054
##  [31] 0.588269425 0.766716658 0.305949455 0.191648159 0.923430953
##  [36] 0.233832635 0.007715163 0.636923221 0.546470935 0.101839183
##  [41] 0.633595727 0.885810579 0.641792946 0.260437129 0.377980255
##  [46] 0.329324914 0.909868603 0.904938123 0.895475321 0.796516410
##  [51] 0.886190335 0.241623031 0.457651060 0.508391008 0.554745562
##  [56] 0.555530013 0.517136450 0.237152954 0.726398646 0.128271193
##  [61] 0.055546426 0.833201948 0.055684921 0.313481890 0.674045813
##  [66] 0.496379419 0.181788795 0.588977335 0.272538493 0.428096391
##  [71] 0.690500493 0.147715047 0.120305341 0.465157841 0.805365236
##  [76] 0.548290932 0.279067560 0.920286134 0.298992191 0.283991735
##  [81] 0.441317646 0.533652819 0.142944393 0.920812613 0.634335308
##  [86] 0.719262180 0.343715387 0.506414946 0.647267652 0.161587341
##  [91] 0.558221586 0.571337643 0.948372532 0.481177694 0.846617931
##  [96] 0.537704063 0.642115127 0.139222858 0.436743209 0.462786126</code></pre>
</div>
<div id="problem-5exercise-6-p214-advanced-r" class="section level2">
<h2>Problem 5(Exercise 6, p214, Advanced R)</h2>
<p>Implement a combination of  and  to create an  variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
</div>
<div id="answer-30" class="section level2">
<h2>Answer</h2>
<p>This exercise is about working with a list of lists, like in the following example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(parallel)
testlist &lt;-<span class="st"> </span><span class="kw">list</span>(iris, mtcars, cars)
<span class="kw">lapply</span>(testlist, <span class="cf">function</span>(x) <span class="kw">vapply</span>(x, mean, <span class="kw">numeric</span>(<span class="dv">1</span>)))</code></pre></div>
<pre><code>## Warning in mean.default(X[[i]], ...): NA</code></pre>
<pre><code>## [[1]]
## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##     5.843333     3.057333     3.758000     1.199333           NA 
## 
## [[2]]
##        mpg        cyl       disp         hp       drat         wt 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250 
##       qsec         vs         am       gear       carb 
##  17.848750   0.437500   0.406250   3.687500   2.812500 
## 
## [[3]]
## speed  dist 
## 15.40 42.98</code></pre>
<p>So we can get the same result with a more specialized function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lmapply &lt;-<span class="st"> </span><span class="cf">function</span>(X, FUN, FUN.VALUE, <span class="dt">simplify =</span> <span class="ot">FALSE</span>){
  out &lt;-<span class="st"> </span><span class="kw">Map</span>(<span class="cf">function</span>(x) <span class="kw">vapply</span>(x, FUN, FUN.VALUE), X)
  <span class="cf">if</span>(simplify <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>){<span class="kw">return</span>(<span class="kw">simplify2array</span>(out))}
  out
}
<span class="kw">lmapply</span>(testlist, mean, <span class="kw">numeric</span>(<span class="dv">1</span>))</code></pre></div>
<pre><code>## Warning in mean.default(X[[i]], ...): NA</code></pre>
<pre><code>## [[1]]
## Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species 
##     5.843333     3.057333     3.758000     1.199333           NA 
## 
## [[2]]
##        mpg        cyl       disp         hp       drat         wt 
##  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250 
##       qsec         vs         am       gear       carb 
##  17.848750   0.437500   0.406250   3.687500   2.812500 
## 
## [[3]]
## speed  dist 
## 15.40 42.98</code></pre>
</div>
<div id="exercise-10-20181214" class="section level2">
<h2>Exercise 10 (20181214)</h2>
</div>
<div id="problem-1-1" class="section level2">
<h2>Problem 1</h2>
<p>Make a faster version of <span class="math inline">\(\textbf{chisq.test()}\)</span> that only computes the chi-square test statistic when the input is two numeric vectors with no missing values. You can try simplifying <span class="math inline">\(\textbf{chisq.test()}\)</span> or by coding from the mathematical definition.</p>
</div>
<div id="answer-31" class="section level2">
<h2>Answer</h2>
<p>Since <span class="math inline">\(\textbf{chisq.test()}\)</span> has a long code, we try a shorter one:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chisq.test2 &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){
  
  <span class="co"># Input</span>
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.numeric</span>(x)) {
    <span class="kw">stop</span>(<span class="st">&quot;x must be numeric&quot;</span>)}
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">is.numeric</span>(y)) {
    <span class="kw">stop</span>(<span class="st">&quot;y must be numeric&quot;</span>)}
  <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(y)) {
    <span class="kw">stop</span>(<span class="st">&quot;x and y must have the same length&quot;</span>)}
  <span class="cf">if</span> (<span class="kw">length</span>(x) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>) {
    <span class="kw">stop</span>(<span class="st">&quot;length of x must be greater one&quot;</span>)}
  <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">c</span>(x, y) <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>)) {
    <span class="kw">stop</span>(<span class="st">&quot;all entries of x and y must be greater or equal zero&quot;</span>)}
  <span class="cf">if</span> (<span class="kw">sum</span>(<span class="kw">complete.cases</span>(x, y)) <span class="op">!=</span><span class="st"> </span><span class="kw">length</span>(x)) {
    <span class="kw">stop</span>(<span class="st">&quot;there must be no missing values in x and y&quot;</span>)}
  <span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">is.null</span>(<span class="kw">c</span>(x, y)))) {
    <span class="kw">stop</span>(<span class="st">&quot;entries of x and y must not be NULL&quot;</span>)}
  
  <span class="co"># compute the theoretical value</span>
  m &lt;-<span class="st"> </span><span class="kw">rbind</span>(x, y)<span class="co">#the actual value</span>
  margin1 &lt;-<span class="st"> </span><span class="kw">rowSums</span>(m)
  margin2 &lt;-<span class="st"> </span><span class="kw">colSums</span>(m)
  n &lt;-<span class="st"> </span><span class="kw">sum</span>(m)
  me &lt;-<span class="st"> </span><span class="kw">tcrossprod</span>(margin1, margin2) <span class="op">/</span><span class="st"> </span>n <span class="co">#the theoretical value</span>
  
  <span class="co"># Output</span>
  STATISTIC =<span class="st"> </span><span class="kw">sum</span>((m <span class="op">-</span><span class="st"> </span>me)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>me)
  dof &lt;-<span class="st"> </span>(<span class="kw">length</span>(margin1) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">length</span>(margin2) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="co">#degree of freedom</span>
  p &lt;-<span class="st"> </span><span class="kw">pchisq</span>(STATISTIC, <span class="dt">df =</span> dof, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">X_squared =</span> STATISTIC, <span class="dt">df =</span> dof, <span class="st">`</span><span class="dt">p-value</span><span class="st">`</span> =<span class="st"> </span>p))
}</code></pre></div>
<p>Then check if <span class="math inline">\(\textbf{chisq.text2()}\)</span> returns the same results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="dv">11</span><span class="op">:</span><span class="dv">15</span>
b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">11</span>,<span class="fl">12.5</span>,<span class="fl">13.5</span>,<span class="fl">14.5</span>,<span class="fl">15.5</span>)
m_test &lt;-<span class="st"> </span><span class="kw">cbind</span>(a,b)

<span class="kw">identical</span>(<span class="kw">chisq.test</span>(m_test),<span class="kw">chisq.test2</span>(a, b))</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>The results are not same.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(m_test)</code></pre></div>
<pre><code>## 
##  Pearson's Chi-squared test
## 
## data:  m_test
## X-squared = 0.0063051, df = 4, p-value = 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test2</span>(a, b)</code></pre></div>
<pre><code>## $X_squared
## [1] 0.006305112
## 
## $df
## [1] 4
## 
## $`p-value`
## [1] 0.999995</code></pre>
<p>By observing the results, we find that there is a slight difference in p value.</p>
<p>Finally compare the run time:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chisq.test2c &lt;-<span class="st"> </span>compiler<span class="op">::</span><span class="kw">cmpfun</span>(chisq.test2)

microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(
  <span class="kw">chisq.test</span>(m_test),
  <span class="kw">chisq.test2</span>(a,b),
  <span class="kw">chisq.test2c</span>(a,b)
)</code></pre></div>
<pre><code>## Unit: microseconds
##                expr    min      lq      mean median       uq      max
##  chisq.test(m_test) 71.254 75.5205 290.07856 82.561 183.6805 9960.961
##   chisq.test2(a, b) 19.627 20.9075  55.71470 24.320  35.8405 1387.521
##  chisq.test2c(a, b) 19.627 20.9070  33.53235 23.894  34.1340  163.414
##  neval
##    100
##    100
##    100</code></pre>
</div>
<div id="problem-2-2" class="section level2">
<h2>Problem 2</h2>
<p>Can you make a faster version of  for the case of an input of two integer vectors with no missing values? Can you use it to speed up your chi-square test?</p>
</div>
<div id="answer-32" class="section level2">
<h2>Answer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">table2 &lt;-<span class="st"> </span><span class="cf">function</span>(x,y){
  
  x_val &lt;-<span class="st"> </span><span class="kw">unique</span>(x)
  y_val &lt;-<span class="st"> </span><span class="kw">unique</span>(y)
  mat &lt;-<span class="st"> </span><span class="kw">matrix</span>(0L, <span class="kw">length</span>(x_val), <span class="kw">length</span>(y_val))
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(x)) {
    mat[<span class="kw">which</span>(x_val <span class="op">==</span><span class="st"> </span>x[[i]]), <span class="kw">which</span>(y_val <span class="op">==</span><span class="st"> </span>y[[i]])] &lt;-
<span class="st">      </span>mat[<span class="kw">which</span>(x_val <span class="op">==</span><span class="st"> </span>x[[i]]),  <span class="kw">which</span>(y_val <span class="op">==</span><span class="st"> </span>y[[i]])] <span class="op">+</span><span class="st"> </span>1L
  }
  dimnames &lt;-<span class="st"> </span><span class="kw">list</span>(x_val, y_val)
  <span class="kw">names</span>(dimnames) &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">as.list</span>(<span class="kw">match.call</span>())[<span class="op">-</span><span class="dv">1</span>])  <span class="co"># R has names for dimnames... :/</span>
  tab &lt;-<span class="st"> </span><span class="kw">array</span>(mat, <span class="dt">dim =</span> <span class="kw">dim</span>(mat), <span class="dt">dimnames =</span> dimnames)
  <span class="kw">class</span>(tab) &lt;-<span class="st"> &quot;table&quot;</span>
  tab
}</code></pre></div>
<p>Then check if <span class="math inline">\(\textbf{table2()}\)</span> returns the same results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)
<span class="kw">identical</span>(<span class="kw">table</span>(x,y), <span class="kw">table2</span>(x,y))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Finally compare the run time:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">microbenchmark<span class="op">::</span><span class="kw">microbenchmark</span>(<span class="kw">table</span>(x,y), <span class="kw">table2</span>(x,y))</code></pre></div>
<pre><code>## Unit: microseconds
##          expr     min       lq     mean  median       uq      max neval
##   table(x, y) 279.894 351.5740 431.8983 361.814 391.4675 1707.520   100
##  table2(x, y) 112.640 118.6145 152.6578 128.428 138.4545  767.574   100</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
